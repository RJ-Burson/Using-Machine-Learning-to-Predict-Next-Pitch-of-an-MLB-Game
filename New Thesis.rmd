---
title: "New Thesis"
output: html_document
date: "2024-02-15"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


library(xgboost)
library(cvms)
library(Ecdat)
library(boot)
library(dplyr)
library(ggplot2)
library(caret)
library(UBL)
library(ROSE)
library(scutr)
library(mclust)
library(parallel)
library(SMOTEWB)
library(cli)
library(digest)
library(fastmap)
library(rlang)
library(htmltools)
library(RMySQL)
library(readxl)
library(ggplot2)                     
library(GGally)
library(caTools)
library(skimr)
library(MASS)
library(caret)
library(class)
library(ROCR)
library(ISLR)
library(boot)
library(tree)
library(randomForest)
library(gbm)
library(tidyverse)
library(cutpointr)
library(car)
library(glmnet)
library(e1071)
library(dplyr)
library(summarytools)
library(foreign)
library(nnet)
library(ggplot2)
library(reshape2)
library(dplyr)
library(GLMcat)
library(data.table)
library(neuralnet)
library(stringi)
library(mltools)
library(data.table)
library(kknn)

```

## Creating all IDs 
```{r}

# Importing all the MLB ids for all of the players

id = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-0.csv")
id1 = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-1.csv")
id2 = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-2.csv")
id3 = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-3.csv")
id4 = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-4.csv")
id5 = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-5.csv")
id6 = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-6.csv")
id7 = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-7.csv")
id8 = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-8.csv")
id9 = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-9.csv")
ida = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-a.csv")
idb = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-b.csv")
idc = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-c.csv")
idd = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-d.csv")
ide = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-e.csv")
idf = read.csv("C:/Users/014497819/Downloads/register-master/register-master/Player IDs/people-f.csv")


# Combining all of the id datasets
ids = do.call("rbind", list(id, id1, id2, id3, id4, id5, id6, id7, 
                            id8, id9, ida, idb, idc, idd, ide, idf))

# Removing all the rows that dont have an mlbid
ids = subset(ids, ids$key_mlbam != "NA")

# Cleaning up the first and last name variables so there isn't any problem matching names later on in the code
ids$name_first = trimws(ids$name_first)
ids$name_first = sub("(\\w+),\\s(\\w+)","\\2 \\1", ids$name_first)
ids$name_first = gsub(" ","", ids$name_first)
ids$name_first = iconv(ids$name_first, to="ASCII//TRANSLIT")
ids$name_last = iconv(ids$name_last, to="ASCII//TRANSLIT")


#Creating the full name variable by combining the first and last name variables
ids = ids %>% mutate(Full_Name = paste(name_first, name_last, sep = " "))
ids$Full_Name = sub("(\\w+),\\s(\\w+)","\\2 \\1", ids$Full_Name)
ids$Full_Name = trimws(ids$Full_Name)


```

# Stolen base threat variable 2021
```{r}

# Importing stolen base data from the 2018-2020 season
sb = read.csv("C:/Users/014497819/Desktop/Thesis/Stolen_bases for 2021.csv")


#Trimming white space and converting first and last name to ascii to match player names later on
sb$first_name = iconv(sb$first_name, to="ASCII//TRANSLIT")
sb$last_name = iconv(sb$last_name, to="ASCII//TRANSLIT")
sb$last_name = trimws(sb$last_name)

# Create a full name variable by combining first and last name variables
sb <- sb %>% mutate(Full_Name = paste(first_name, last_name, sep = " "))


# Group data by player
stolen_bases_by_player_2021 = sb %>% group_by(Full_Name) %>% summarise(total_stolen_bases = sum(r_total_stolen_base))

#Scaling the stolen bases variable
stolen_bases_by_player_2021$stand_sb = scale(stolen_bases_by_player_2021$total_stolen_bases)

#Fixing the full name variable to match player names later on
stolen_bases_by_player_2021$Full_Name = sub("(\\w+),\\s(\\w+)","\\2 \\1", stolen_bases_by_player_2021$Full_Name)
stolen_bases_by_player_2021$Full_Name = trimws(stolen_bases_by_player_2021$Full_Name)

```

## Creating catcher defensive variables 2021
```{r}
# Creating blocking and caught stealing dataset for catchers

#Importing catcher Blocking data from the years 2018-2020
df_blocking = read.csv("C:/Users/014497819/Desktop/Thesis/catcher_blocking for 2021.csv")

#Converting to ASCII to match players later on
df_blocking$first_name = iconv(df_blocking$first_name, to="ASCII//TRANSLIT")
df_blocking$last_name = iconv(df_blocking$last_name, to="ASCII//TRANSLIT")

#Creating the full name variable
df_blocking <- df_blocking %>% mutate(Full_Name = paste(first_name, last_name, sep = " "))



#Importing catcher throwing data from the years 2018-2020
df_throwing = as_tibble(read.csv("C:/Users/014497819/Desktop/Thesis/catcher_throwing for 2021.csv"))

#Converting to ASCII to match players later on
df_throwing$first_name = iconv(df_throwing$first_name, to="ASCII//TRANSLIT")
df_throwing$last_name = iconv(df_throwing$last_name, to="ASCII//TRANSLIT")

#Creating the full name variable
df_throwing <- df_throwing %>% mutate(Full_Name = paste(first_name, last_name, sep = " "))




# Merge the two catcher data frames together by the cathers Full Name
total <- merge(df_throwing, df_blocking, by="Full_Name")

# Only selecting columns needed from the catching data
catcher_data_2021 = total[, c(1,10, 34)]


# Scaling the throwing and blocking variables
catcher_data_2021 <- 
  catcher_data_2021 %>% 
  mutate(stand_blocking = scale(catcher_data_2021$blocks_above_average), stand_throwing = scale(catcher_data_2021$caught_stealing_above_average))

#Fixing the full name variable to match player names later on
catcher_data_2021$Full_Name = trimws(catcher_data_2021$Full_Name)
catcher_data_2021$Full_Name = sub("(\\w+),\\s(\\w+)","\\2 \\1", catcher_data_2021$Full_Name)
catcher_data_2021$Full_Name = iconv(catcher_data_2021$Full_Name, to="ASCII//TRANSLIT")

```

# OPS variable 2021
```{r}

#Importing OPS dataset for 2021 from the 2018-2020 seasons
ops_2021 = read.csv("C:/Users/014497819/Desktop/Thesis/OPS for 2021.csv")

#Only selecting the variables needed
ops_2021 = ops_2021[, c(1,2,5)]

#Trimming whitespace and converting to ASCII to match players later on
ops_2021$first_name = iconv(ops_2021$first_name, to="ASCII//TRANSLIT")
ops_2021$last_name = iconv(ops_2021$last_name, to="ASCII//TRANSLIT")
ops_2021$last_name = trimws(ops_2021$last_name)

#Creating the full name variable
ops_2021 <- ops_2021 %>% mutate(Full_Name = paste(first_name, last_name, sep = " "))


#Trimming whitespace and converting to ASCII to match players later on
ops_2021$Full_Name = sub("(\\w+),\\s(\\w+)","\\2 \\1", ops_2021$Full_Name)
ops_2021$Full_Name = trimws(ops_2021$Full_Name)
ops_2021$Full_Name = iconv(ops_2021$Full_Name, to="ASCII//TRANSLIT")

#Only selecting the variables needed
ops_2021 = ops_2021[, c(3,4)]


#Averaging players OPS over the previous three years
ops_2021 = ops_2021 %>% group_by(Full_Name) %>% summarise(mean_on_base_plus_slg = mean(on_base_plus_slg))
```

## Creating stolen base threat variable 2022
```{r}

# Importing stolen base data from the 2019-2021 season to add runner stolen base threats
sb = read.csv("C:/Users/014497819/Desktop/Thesis/Stolen_bases for 2022.csv")


# Converting to ascii and trimming white space to match player names later on 
sb$first_name = iconv(sb$first_name, to="ASCII//TRANSLIT")
sb$last_name = iconv(sb$last_name, to="ASCII//TRANSLIT")
sb$last_name = trimws(sb$last_name)

# Create a full name variable by combining first and last name variables 
sb <- sb %>% mutate(Full_Name = paste(first_name, last_name, sep = " "))

# Group data by player
stolen_bases_by_player_2022 = sb %>% group_by(Full_Name) %>% summarise(total_stolen_bases = sum(r_total_stolen_base))

#Scaling the stolen bases variable
stolen_bases_by_player_2022$stand_sb = scale(stolen_bases_by_player_2022$total_stolen_bases)


#Fixing the full name variable to match player names later on
stolen_bases_by_player_2022$Full_Name = sub("(\\w+),\\s(\\w+)","\\2 \\1", stolen_bases_by_player_2022$Full_Name)
stolen_bases_by_player_2022$Full_Name = trimws(stolen_bases_by_player_2022$Full_Name)


```

## Creating catcher defensive variables 2022
```{r}
#BLOCKING DATA

# Importing catcher Blocking data from the 2019-2021 seasons
df_blocking = read.csv("C:/Users/014497819/Desktop/Thesis/catcher_blocking for 2022.csv")

#Converting to ASCII to match players later on
df_blocking$first_name = iconv(df_blocking$first_name, to="ASCII//TRANSLIT")
df_blocking$last_name = iconv(df_blocking$last_name, to="ASCII//TRANSLIT")

#Creating the full name variable in the catcher blocking data
df_blocking <- df_blocking %>% mutate(Full_Name = paste(first_name, last_name, sep = " "))




#THROWING DATA

#Importing catcher throwing data from the years 2018-2020
df_throwing = as_tibble(read.csv("C:/Users/014497819/Desktop/Thesis/catcher_throwing for 2022.csv"))

#Converting to ASCII to match players later on
df_throwing$first_name = iconv(df_throwing$first_name, to="ASCII//TRANSLIT")
df_throwing$last_name = iconv(df_throwing$last_name, to="ASCII//TRANSLIT")

#Creating the full name variable in the catcher blocking data
df_throwing <- df_throwing %>% mutate(Full_Name = paste(first_name, last_name, sep = " "))


#Merging the two datasets by the full name of the catchers
total <- merge(df_throwing, df_blocking, by="Full_Name")

#Only selecting the variables needed
catcher_data_2022 = total[, c(1,10, 34)]


#Scaling the catcher blocking and throwing stats
catcher_data_2022 <- 
  catcher_data_2022 %>% 
  mutate(stand_blocking = scale(catcher_data_2022$blocks_above_average), stand_throwing = scale(catcher_data_2022$caught_stealing_above_average))


#Fixing the full name variable to match player names later on
catcher_data_2022$Full_Name = trimws(catcher_data_2022$Full_Name)
catcher_data_2022$Full_Name = sub("(\\w+),\\s(\\w+)","\\2 \\1", catcher_data_2022$Full_Name)
catcher_data_2022$Full_Name = iconv(catcher_data_2022$Full_Name, to="ASCII//TRANSLIT")

```

# OPS variable 2022
```{r}

# Importing the OPS dataset for 2022 from the 2019-2021 seasons
ops_2022 = read.csv("C:/Users/014497819/Desktop/Thesis/OPS for 2022.csv")

#Only selecting the variables needed
ops_2022 = ops_2022[, c(1,2,5)]

#Trimming whitespace and converting to ASCII to match players later on
ops_2022$first_name = iconv(ops_2022$first_name, to="ASCII//TRANSLIT")
ops_2022$last_name = iconv(ops_2022$last_name, to="ASCII//TRANSLIT")
ops_2022$last_name = trimws(ops_2022$last_name)

#Creating the full name variable
ops_2022 <- ops_2022 %>% mutate(Full_Name = paste(first_name, last_name, sep = " "))


#Trimming whitespace and converting to ASCII to match players later on
ops_2022$Full_Name = sub("(\\w+),\\s(\\w+)","\\2 \\1", ops_2022$Full_Name)
ops_2022$Full_Name = trimws(ops_2022$Full_Name)
ops_2022$Full_Name = iconv(ops_2022$Full_Name, to="ASCII//TRANSLIT")

#Only selecting the variables needed
ops_2022 = ops_2022[, c(3,4)]


#Averaging players OPS over the previous three years
ops_2022 = ops_2022 %>% group_by(Full_Name) %>% summarise(mean_on_base_plus_slg = mean(on_base_plus_slg))
```


## Building the new train set
```{r}

# Importing all the pitches from the 2021 season
df = read.csv("C:/Users/014497819/Desktop/Thesis/2021 Pitches.csv")

#Replacing all variables that have players id #s into the players names by matching players full names in the 2021 pitches dataset and the mlbids dataset
df[["batter"]] = ids[ match(df[["batter"]], ids[["key_mlbam"]]), 'Full_Name']
df[["pitcher"]] = ids[ match(df[["pitcher"]], ids[["key_mlbam"]]), 'Full_Name']
df[["fielder_2"]] = ids[ match(df[["fielder_2"]], ids[["key_mlbam"]]), 'Full_Name']
df[["on_3b"]] = ids[ match(df[["on_3b"]], ids[["key_mlbam"]]), 'Full_Name']
df[["on_2b"]] = ids[ match(df[["on_2b"]], ids[["key_mlbam"]]), 'Full_Name']
df[["on_1b"]] = ids[ match(df[["on_1b"]], ids[["key_mlbam"]]), 'Full_Name']


#Creating variables for the catchers and baserunners and populating them with NAs
dfv = cbind(df, catcher_blocking=NA, catcher_throwing = NA, sb_threat1= NA, sb_threat2= NA, sb_threat3= NA, OPS = NA) 


# Replacing the NAs with actual players scaled stats. Do so by matching players names from the ids dataset and the catcher blocking/throwing, stolen bases, and OPS datasets
dfv$catcher_throwing =  catcher_data_2021[ match(dfv$fielder_2, catcher_data_2021$Full_Name), 'stand_throwing']
dfv$catcher_blocking =  catcher_data_2021[ match(dfv$fielder_2, catcher_data_2021$Full_Name), 'stand_blocking']
dfv$sb_threat1 =  stolen_bases_by_player_2021[ match(dfv$on_1b, stolen_bases_by_player_2021$Full_Name), 'stand_sb']
dfv$sb_threat2 =  stolen_bases_by_player_2021[ match(dfv$on_2b, stolen_bases_by_player_2021$Full_Name), 'stand_sb']
dfv$sb_threat3 =  stolen_bases_by_player_2021[ match(dfv$on_3b, stolen_bases_by_player_2021$Full_Name), 'stand_sb']
dfv$OPS =  ops_2021[match(dfv$batter, ops_2021$Full_Name), 'mean_on_base_plus_slg']


# pick only the columns of data that are needed
dfv = dfv[,c(8,9,11,16,17,19,20,26,27,33:38,43,78:84,94:99)] 


### Replace all the on base variables that are populated with 'LAST PLAYER' and replace with 0 
dfv$sb_threat1[is.na(dfv$sb_threat1)] = 0  
dfv$sb_threat2[is.na(dfv$sb_threat2)] = 0
dfv$sb_threat3[is.na(dfv$sb_threat3)] = 0

#unlisting the stolen base threat variables and OPS variable
dfv$sb_threat1 = unlist(dfv$sb_threat1)
dfv$sb_threat2 = unlist(dfv$sb_threat2)
dfv$sb_threat3 = unlist(dfv$sb_threat3)
dfv$OPS = unlist(dfv$OPS)


# Replacing remaining NA values in the OPS and catcher variables with the mean values of each respective variable. The existing NAs still remain because some catchers didnt play enough to qualify for some the the statistics. So they arent in the OPS or catching datasets and no way to match their names.  
m =  mean(dfv$OPS, na.rm = TRUE)
dfv$OPS = ifelse(is.na(dfv$OPS), m, dfv$OPS)

l =  mean(dfv$catcher_throwing , na.rm = TRUE)
dfv$catcher_throwing = ifelse(is.na(dfv$catcher_throwing), l, dfv$catcher_throwing) 

i=  mean(dfv$catcher_blocking, na.rm = TRUE)
dfv$catcher_blocking = ifelse(is.na(dfv$catcher_blocking), i, dfv$catcher_blocking)



# Making batter stance, pitcher handedness, and what half of the inning it is into factors
dfv$stand = as.factor(ifelse(dfv$stand=="R",1,0))## Determining batter stance
dfv$p_throws = as.factor(ifelse(dfv$p_throws=="R",1,0))
dfv$inning_topbot = as.factor(ifelse(dfv$inning_topbot=="Top",1,0))



# Getting rid of the variable pitch name
new_train = dfv[,-c(1,5,16)]

# Filtering the data to have only pitches who threw at least 500 pitches in 2021
new_train = new_train %>% group_by(pitcher) %>% filter(n()>= 500) %>% ungroup()

#Getting rid of pitches that dont have a pitch name for whatever reason
new_train = new_train[-(which(new_train$pitch_name %in% "")),]

#Changing one of the pitch names to "Splitter" 
new_train$pitch_name = ifelse(new_train$pitch_name== "Split-Finger", "Splitter", new_train$pitch_name)

#Combining similar pitches (Slurve, Slow Curve, Knuckle Curve, and Curveball)
new_train$pitch_name = ifelse(new_train$pitch_name=="Slurve", "Curveball", new_train$pitch_name)
new_train$pitch_name = ifelse(new_train$pitch_name=="Slow Curve", "Curveball", new_train$pitch_name)
new_train$pitch_name = ifelse(new_train$pitch_name=="Knuckle Curve", "Curveball", new_train$pitch_name)


```


## Building the new validation set
```{r}

# Importing all the pitches from the 2022 season Pre All-Star break
df = read.csv("C:/Users/014497819/Desktop/Thesis/2022 Pitches Pre All-Star.csv")

#Replacing all variables that have players id #s into the players names by matching players full names in the 2021 pitches dataset and the mlbids dataset
df[["batter"]] = ids[ match(df[["batter"]], ids[["key_mlbam"]]), 'Full_Name']
df[["pitcher"]] = ids[ match(df[["pitcher"]], ids[["key_mlbam"]]), 'Full_Name']
df[["fielder_2"]] = ids[ match(df[["fielder_2"]], ids[["key_mlbam"]]), 'Full_Name']
df[["on_3b"]] = ids[ match(df[["on_3b"]], ids[["key_mlbam"]]), 'Full_Name']
df[["on_2b"]] = ids[ match(df[["on_2b"]], ids[["key_mlbam"]]), 'Full_Name']
df[["on_1b"]] = ids[ match(df[["on_1b"]], ids[["key_mlbam"]]), 'Full_Name']


#Creating variables for the catchers and baserunners and populating them with NAs
dfv = cbind(df, catcher_blocking=NA, catcher_throwing = NA, sb_threat1= NA, sb_threat2= NA, sb_threat3= NA, OPS = NA) 


# Replacing the NAs with actual players scaled stats. Do so by matching players names from the ids dataset and the catcher blocking/throwing, stolen bases, and OPS datasets
dfv$catcher_throwing =  catcher_data_2022[ match(dfv$fielder_2, catcher_data_2022$Full_Name), 'stand_throwing']
dfv$catcher_blocking =  catcher_data_2022[ match(dfv$fielder_2, catcher_data_2022$Full_Name), 'stand_blocking']
dfv$sb_threat1 =  stolen_bases_by_player_2022[ match(dfv$on_1b, stolen_bases_by_player_2022$Full_Name), 'stand_sb']
dfv$sb_threat2 =  stolen_bases_by_player_2022[ match(dfv$on_2b, stolen_bases_by_player_2022$Full_Name), 'stand_sb']
dfv$sb_threat3 =  stolen_bases_by_player_2022[ match(dfv$on_3b, stolen_bases_by_player_2022$Full_Name), 'stand_sb']
dfv$OPS =  ops_2022[ match(dfv$batter, ops_2022$Full_Name), 'mean_on_base_plus_slg']


# pick only the columns of data that are needed
dfv = dfv[,c(8,9,11,16,17,19,20,26,27,33:38,43,78:84,94:99)] 


### Replace all the on base variables that are populated with 'LAST PLAYER' and replace with 0
dfv$sb_threat1[is.na(dfv$sb_threat1)] = 0
dfv$sb_threat2[is.na(dfv$sb_threat2)] = 0
dfv$sb_threat3[is.na(dfv$sb_threat3)] = 0

#unlisting the stolen base threat variables and OPS variable
dfv$sb_threat1 = unlist(dfv$sb_threat1)
dfv$sb_threat2 = unlist(dfv$sb_threat2)
dfv$sb_threat3 = unlist(dfv$sb_threat3)
dfv$OPS = unlist(dfv$OPS)


# Replacing remaining NA values in the OPS and catcher variables with the mean values of each respective variable. The existing NAs still remain because some catchers didnt play enough to qualify for some the the statistics. So they arent in the OPS or catching datasets and no way to match their names. 
m = mean(dfv$OPS, na.rm = TRUE)
dfv$OPS = ifelse(is.na(dfv$OPS), m, dfv$OPS)

l =  mean(dfv$catcher_throwing , na.rm = TRUE)
dfv$catcher_throwing = ifelse(is.na(dfv$catcher_throwing), l, dfv$catcher_throwing) 

i=  mean(dfv$catcher_blocking, na.rm = TRUE)
dfv$catcher_blocking = ifelse(is.na(dfv$catcher_blocking), i, dfv$catcher_blocking)


# Making batter stance, pitcher handedness, and what half of the inning it is into factors
dfv$stand = as.factor(ifelse(dfv$stand=="R",1,0))## Determining batter stance
dfv$p_throws = as.factor(ifelse(dfv$p_throws=="R",1,0))
dfv$inning_topbot = as.factor(ifelse(dfv$inning_topbot=="Top",1,0))



# Getting rid of the variable pitch name
vald_set = dfv[,-c(1,5,16)]


#Getting rid of pitches that dont have a pitch name for whatever reason
vald_set = vald_set[-(which(vald_set$pitch_name %in% "")),]

#Changing one of the pitch names to "Splitter" 
vald_set$pitch_name = ifelse(vald_set$pitch_name== "Split-Finger", "Splitter", vald_set$pitch_name)

#Combine Some like pitches (Slurve, Slow Curve, Knuckle Curve, and Curveball)
vald_set$pitch_name = ifelse(vald_set$pitch_name=="Slurve", "Curveball", vald_set$pitch_name)
vald_set$pitch_name = ifelse(vald_set$pitch_name=="Slow Curve", "Curveball", vald_set$pitch_name)
vald_set$pitch_name = ifelse(vald_set$pitch_name=="Knuckle Curve", "Curveball", vald_set$pitch_name)

```


## Building the new test set
```{r}

# Importing all the pitches from the 2022 season Post All-Star break
df = read.csv("C:/Users/014497819/Desktop/Thesis/2022 Pitches Post All-Star.csv")

#Replacing all variables that have players id #s into the players names by matching players full names in the 2021 pitches dataset and the mlbids dataset
df[["batter"]] = ids[ match(df[["batter"]], ids[["key_mlbam"]]), 'Full_Name']
df[["pitcher"]] = ids[ match(df[["pitcher"]], ids[["key_mlbam"]]), 'Full_Name']
df[["fielder_2"]] = ids[ match(df[["fielder_2"]], ids[["key_mlbam"]]), 'Full_Name']
df[["on_3b"]] = ids[ match(df[["on_3b"]], ids[["key_mlbam"]]), 'Full_Name']
df[["on_2b"]] = ids[ match(df[["on_2b"]], ids[["key_mlbam"]]), 'Full_Name']
df[["on_1b"]] = ids[ match(df[["on_1b"]], ids[["key_mlbam"]]), 'Full_Name']


#Creating variables for the catchers and baserunners and populating them with NAs
dfv = cbind(df, catcher_blocking=NA, catcher_throwing = NA, sb_threat1= NA, sb_threat2= NA, sb_threat3= NA, OPS = NA) 


# Replacing the NAs with actual players scaled stats. Do so by matching players names from the ids dataset and the catcher blocking/throwing, stolen bases, and OPS datasets
dfv$catcher_throwing =  catcher_data_2022[ match(dfv$fielder_2, catcher_data_2022$Full_Name), 'stand_throwing']
dfv$catcher_blocking =  catcher_data_2022[ match(dfv$fielder_2, catcher_data_2022$Full_Name), 'stand_blocking']
dfv$sb_threat1 =  stolen_bases_by_player_2022[ match(dfv$on_1b, stolen_bases_by_player_2022$Full_Name), 'stand_sb']
dfv$sb_threat2 =  stolen_bases_by_player_2022[ match(dfv$on_2b, stolen_bases_by_player_2022$Full_Name), 'stand_sb']
dfv$sb_threat3 =  stolen_bases_by_player_2022[ match(dfv$on_3b, stolen_bases_by_player_2022$Full_Name), 'stand_sb']
dfv$OPS =  ops_2022[ match(dfv$batter, ops_2022$Full_Name), 'mean_on_base_plus_slg']


# pick only the columns of data that are needed
dfv = dfv[,c(8,9,11,16,17,19,20,26,27,33:38,43,78:84,94:99)] 


### Replace all the on base variables that are populated with 'LAST PLAYER' and replace with 0
dfv$sb_threat1[is.na(dfv$sb_threat1)] = 0
dfv$sb_threat2[is.na(dfv$sb_threat2)] = 0
dfv$sb_threat3[is.na(dfv$sb_threat3)] = 0

#unlisting the stolen base threat variables and OPS variable
dfv$sb_threat1 = unlist(dfv$sb_threat1)
dfv$sb_threat2 = unlist(dfv$sb_threat2)
dfv$sb_threat3 = unlist(dfv$sb_threat3)
dfv$OPS = unlist(dfv$OPS)


# Replacing remaining NA values in the OPS and catcher variables with the mean values of each respective variable. The existing NAs still remain because some catchers didnt play enough to qualify for some the the statistics. So they arent in the OPS or catching datasets and no way to match their names. 
m = mean(dfv$OPS, na.rm = TRUE)
dfv$OPS = ifelse(is.na(dfv$OPS), m, dfv$OPS)

l =  mean(dfv$catcher_throwing , na.rm = TRUE)
dfv$catcher_throwing = ifelse(is.na(dfv$catcher_throwing), l, dfv$catcher_throwing) 

i=  mean(dfv$catcher_blocking, na.rm = TRUE)
dfv$catcher_blocking = ifelse(is.na(dfv$catcher_blocking), i, dfv$catcher_blocking)



# Making batter stance, pitcher handedness, and what half of the inning it is into factors
dfv$stand = as.factor(ifelse(dfv$stand=="R",1,0))## Determining batter stance
dfv$p_throws = as.factor(ifelse(dfv$p_throws=="R",1,0))
dfv$inning_topbot = as.factor(ifelse(dfv$inning_topbot=="Top",1,0))



# Getting rid of the variable pitch name
test_set = dfv[,-c(1,5,16)]


#Getting rid of pitches that dont have a pitch name for whatever reason
test_set = test_set[-(which(test_set$pitch_name %in% "")),]

#Changing one of the pitch names to "Splitter" 
test_set$pitch_name = ifelse(test_set$pitch_name== "Split-Finger", "Splitter", test_set$pitch_name)

#Combine Some like pitches (Slurve, Slow Curve, Knuckle Curve, and Curveball)
test_set$pitch_name = ifelse(test_set$pitch_name=="Slurve", "Curveball", test_set$pitch_name)
test_set$pitch_name = ifelse(test_set$pitch_name=="Slow Curve", "Curveball", test_set$pitch_name)
test_set$pitch_name = ifelse(test_set$pitch_name=="Knuckle Curve", "Curveball", test_set$pitch_name)


```


#Find which pitchers threw 500 pitches in both 2021 and 2022
```{r}

#Combinging the Pre all-star break and post all-star break dataset to create a dataset containing all the pitches from the 2022 season
new_2022 = rbind(vald_set, test_set)

# Filtering the 2022 season dataset to have only pitches who threw at least 500 pitches in 2021 
new_2022 = new_2022 %>% group_by(pitcher) %>% filter(n()>= 500) %>% ungroup()


#Finding the pitchers who were in each of the 3 datasets. The 2021 season, 2022 pre all star break, and 2022 post all star break
h= unique(new_2022$pitcher)
j=unique(vald_set$pitcher)
n=unique(test_set$pitcher)

# Finding the pitchers who were in all three of the datasets
o = subset(new_train, new_train$pitcher %in% h)
d= subset(o, o$pitcher %in% j)
e= subset(d, d$pitcher %in% n)


i = unique(e$pitcher)

# Did it this complicated way because there are pitchers who threw 500 pitches in both seasons but are not in the validation or test_set because they got injured or came back from an injury halfway through the season. Walker Buehler is one example who got injured halfway through the 2022 season.

```


## new validation/test 
```{r}

#Creating the new training, validation, and test sets with only the pitchers that threw 500 pitches in both the 2021 and 2022 seasons and were in all3 datasets (2021 season, pre all-star break 2022, and post all-star break 2022)
new_train = new_train[new_train$pitcher %in% i,]
vald_set = vald_set[vald_set$pitcher %in% i,]
test_set = test_set[test_set$pitcher %in% i,]


```


# Previous pitch and previous pitch result (TRAIN)
```{r}

#Creating the three variables related to the previous pitch of an at bat for the training data
new_col_name = "prev_pitch"
new_col_value = "pitch_name"

new_col_name1 = "prev_pitch_result"
new_col_value1 = "description"

new_col_name2 = "prev_pitch_location"
new_col_value2 = "zone"

   dfvnew_train <- new_train %>% group_by(new_train$pitcher) %>%
      mutate(!!new_col_name := lead(!!as.symbol(new_col_value))) %>% 
        mutate(!!new_col_name1 := lead(!!as.symbol(new_col_value1))) %>% 
        mutate(!!new_col_name2 := lead(!!as.symbol(new_col_value2)))

   
# Making the 3 previous pitch variable values = 0 when it is the first pitch of an at bat 
dfvnew_train$prev_pitch = ifelse(dfvnew_train$pitch_number == 1, 0, dfvnew_train$prev_pitch)
dfvnew_train$prev_pitch_result = ifelse(dfvnew_train$pitch_number == 1, 0, dfvnew_train$prev_pitch_result)
dfvnew_train$prev_pitch_location = ifelse(dfvnew_train$pitch_number == 1, 0, dfvnew_train$prev_pitch_location)

#Removing the columns not needed
dfvnew_train = dfvnew_train[, -c(2,3,8,9,10,27)]

#Making the previous pitch variables factors
dfvnew_train$prev_pitch =  as.factor(dfvnew_train$prev_pitch)
dfvnew_train$prev_pitch_result = as.factor(dfvnew_train$prev_pitch_result)
dfvnew_train$prev_pitch_location = as.factor(dfvnew_train$prev_pitch_location)


#Code to change factor variable levels from strings into integers for the variables pitch name, previous pitch, and the previous pitch result

#Pitch Name
dfvnew_train <- dfvnew_train %>% 
              mutate(pitch_name = as.factor(case_when((pitch_name == "4-Seam Fastball") ~ 1,
                                             (pitch_name == "Changeup") ~ 2,
                                             (pitch_name == "Curveball") ~ 3,
                                             (pitch_name == "Cutter") ~ 4,
                                             (pitch_name == "Sinker") ~ 5,
                                             (pitch_name == "Slider") ~ 6,
                                             (pitch_name == "Splitter") ~ 7,
                                             (pitch_name == "Sweeper") ~ 8)))


#Previous Pitch
dfvnew_train <- dfvnew_train %>% 
              mutate(prev_pitch = as.factor(case_when((prev_pitch == "0") ~ 0,
                                             (prev_pitch == "4-Seam Fastball") ~ 1,
                                             (prev_pitch == "Changeup") ~ 2,
                                             (prev_pitch == "Curveball") ~ 3,
                                             (prev_pitch == "Cutter") ~ 4,
                                             (prev_pitch == "Sinker") ~ 5,
                                             (prev_pitch == "Slider") ~ 6,
                                             (prev_pitch == "Splitter") ~ 7,
                                             (prev_pitch == "Sweeper") ~ 8)))



#Previous pitch result
dfvnew_train <- dfvnew_train %>% 
              mutate(prev_pitch_result = as.factor(case_when((prev_pitch_result == "0") ~ 0,
                                             (prev_pitch_result == "ball") ~ 1,
                                             (prev_pitch_result == "foul") ~ 2,
                                             (prev_pitch_result == "called_strike") ~ 3,
                                             (prev_pitch_result == "swinging_strike") ~ 4,
                                             (prev_pitch_result == "blocked_ball") ~ 1,
                                             (prev_pitch_result == "foul_tip") ~ 4,
                                             (prev_pitch_result == "swinging_strike_blocked") ~ 4,
                                             (prev_pitch_result == "foul_bunt") ~ 2,
                                             (prev_pitch_result == "missed_bunt") ~ 4,
                                             (prev_pitch_result == "bunt_foul_tip") ~ 4)))


# Omitting the final observations that still may have NAs in them
dfvnew_train= na.omit(dfvnew_train)

```


# Previous pitch and previous pitch result (VALIDATION)
```{r}


#Creating the three variables related to the previous pitch of an at bat for the validation data
new_col_name = "prev_pitch"
new_col_value = "pitch_name"

new_col_name1 = "prev_pitch_result"
new_col_value1 = "description"

new_col_name2 = "prev_pitch_location"
new_col_value2 = "zone"

   dfvnew_valid <- vald_set %>% group_by(vald_set$pitcher) %>%
      mutate(!!new_col_name := lead(!!as.symbol(new_col_value))) %>% 
        mutate(!!new_col_name1 := lead(!!as.symbol(new_col_value1))) %>% 
        mutate(!!new_col_name2 := lead(!!as.symbol(new_col_value2)))

   
# Making the 3 previous pitch variable values = 0 when it is the first pitch of an at bat
dfvnew_valid$prev_pitch = ifelse(dfvnew_valid$pitch_number == 1, 0, dfvnew_valid$prev_pitch)
dfvnew_valid$prev_pitch_result = ifelse(dfvnew_valid$pitch_number == 1, 0, dfvnew_valid$prev_pitch_result)
dfvnew_valid$prev_pitch_location = ifelse(dfvnew_valid$pitch_number == 1, 0, dfvnew_valid$prev_pitch_location)


#Removing the columns not needed
dfvnew_valid = dfvnew_valid[, -c(2,3,8,9,10,27)]


#Making the previous pitch variables factors
dfvnew_valid$prev_pitch =  as.factor(dfvnew_valid$prev_pitch)
dfvnew_valid$prev_pitch_result = as.factor(dfvnew_valid$prev_pitch_result)
dfvnew_valid$prev_pitch_location = as.factor(dfvnew_valid$prev_pitch_location)



#Code to change factor variable levels from strings into integers for the variables pitch name, previous pitch, and the previous pitch result

#Pitch Name
dfvnew_valid <- dfvnew_valid %>% 
              mutate(pitch_name = as.factor(case_when((pitch_name == "4-Seam Fastball") ~ 1,
                                             (pitch_name == "Changeup") ~ 2,
                                             (pitch_name == "Curveball") ~ 3,
                                             (pitch_name == "Cutter") ~ 4,
                                             (pitch_name == "Sinker") ~ 5,
                                             (pitch_name == "Slider") ~ 6,
                                             (pitch_name == "Splitter") ~ 7,
                                             (pitch_name == "Sweeper") ~ 8)))


#Previous Pitch

dfvnew_valid <- dfvnew_valid %>% 
              mutate(prev_pitch = as.factor(case_when((prev_pitch == "0") ~ 0,
                                             (prev_pitch == "4-Seam Fastball") ~ 1,
                                             (prev_pitch == "Changeup") ~ 2,
                                             (prev_pitch == "Curveball") ~ 3,
                                             (prev_pitch == "Cutter") ~ 4,
                                             (prev_pitch == "Sinker") ~ 5,
                                             (prev_pitch == "Slider") ~ 6,
                                             (prev_pitch == "Splitter") ~ 7,
                                             (prev_pitch == "Sweeper") ~ 8)))



#Previous pitch result

dfvnew_valid <- dfvnew_valid %>% 
              mutate(prev_pitch_result = as.factor(case_when((prev_pitch_result == "0") ~ 0,
                                             (prev_pitch_result == "ball") ~ 1,
                                             (prev_pitch_result == "foul") ~ 2,
                                             (prev_pitch_result == "called_strike") ~ 3,
                                             (prev_pitch_result == "swinging_strike") ~ 4,
                                             (prev_pitch_result == "blocked_ball") ~ 1,
                                             (prev_pitch_result == "foul_tip") ~ 4,
                                             (prev_pitch_result == "swinging_strike_blocked") ~ 4,
                                             (prev_pitch_result == "foul_bunt") ~ 2,
                                             (prev_pitch_result == "missed_bunt") ~ 4,
                                             (prev_pitch_result == "bunt_foul_tip") ~ 4)))


# Omitting the final observations that still may have NAs in them
dfvnew_valid= na.omit(dfvnew_valid)

```


# Previous pitch and previous pitch result (TEST)
```{r}


#Creating the three variables related to the previous pitch of an at bat for the test data
new_col_name = "prev_pitch"
new_col_value = "pitch_name"

new_col_name1 = "prev_pitch_result"
new_col_value1 = "description"

new_col_name2 = "prev_pitch_location"
new_col_value2 = "zone"

   dfvnew_test <- test_set %>% group_by(test_set$pitcher) %>%
      mutate(!!new_col_name := lead(!!as.symbol(new_col_value))) %>% 
        mutate(!!new_col_name1 := lead(!!as.symbol(new_col_value1))) %>% 
        mutate(!!new_col_name2 := lead(!!as.symbol(new_col_value2)))

   
# Making the 3 previous pitch variable values = 0 when it is the first pitch of an at bat
dfvnew_test$prev_pitch = ifelse(dfvnew_test$pitch_number == 1, 0, dfvnew_test$prev_pitch)
dfvnew_test$prev_pitch_result = ifelse(dfvnew_test$pitch_number == 1, 0, dfvnew_test$prev_pitch_result)
dfvnew_test$prev_pitch_location = ifelse(dfvnew_test$pitch_number == 1, 0, dfvnew_test$prev_pitch_location)


#Removing the columns not needed
dfvnew_test = dfvnew_test[, -c(2,3,8,9,10,27)]


#Making the previous pitch variables factors
dfvnew_test$prev_pitch =  as.factor(dfvnew_test$prev_pitch)
dfvnew_test$prev_pitch_result = as.factor(dfvnew_test$prev_pitch_result)
dfvnew_test$prev_pitch_location = as.factor(dfvnew_test$prev_pitch_location)


#Code to change factor variable levels from strings into integers for the variables pitch name, previous pitch, and the previous pitch result
#Pitch Name
dfvnew_test <- dfvnew_test %>% 
              mutate(pitch_name = as.factor(case_when((pitch_name == "4-Seam Fastball") ~ 1,
                                             (pitch_name == "Changeup") ~ 2,
                                             (pitch_name == "Curveball") ~ 3,
                                             (pitch_name == "Cutter") ~ 4,
                                             (pitch_name == "Sinker") ~ 5,
                                             (pitch_name == "Slider") ~ 6,
                                             (pitch_name == "Splitter") ~ 7,
                                             (pitch_name == "Sweeper") ~ 8)))


#Previous Pitch

dfvnew_test <- dfvnew_test %>% 
              mutate(prev_pitch = as.factor(case_when((prev_pitch == "0") ~ 0,
                                             (prev_pitch == "4-Seam Fastball") ~ 1,
                                             (prev_pitch == "Changeup") ~ 2,
                                             (prev_pitch == "Curveball") ~ 3,
                                             (prev_pitch == "Cutter") ~ 4,
                                             (prev_pitch == "Sinker") ~ 5,
                                             (prev_pitch == "Slider") ~ 6,
                                             (prev_pitch == "Splitter") ~ 7,
                                             (prev_pitch == "Sweeper") ~ 8)))



#Previous pitch result

dfvnew_test <- dfvnew_test %>% 
              mutate(prev_pitch_result = as.factor(case_when((prev_pitch_result == "0") ~ 0,
                                             (prev_pitch_result == "ball") ~ 1,
                                             (prev_pitch_result == "foul") ~ 2,
                                             (prev_pitch_result == "called_strike") ~ 3,
                                             (prev_pitch_result == "swinging_strike") ~ 4,
                                             (prev_pitch_result == "blocked_ball") ~ 1,
                                             (prev_pitch_result == "foul_tip") ~ 4,
                                             (prev_pitch_result == "swinging_strike_blocked") ~ 4,
                                             (prev_pitch_result == "foul_bunt") ~ 2,
                                             (prev_pitch_result == "missed_bunt") ~ 4,
                                             (prev_pitch_result == "bunt_foul_tip") ~ 4)))


# Omitting the final observations that still may have NAs in them
dfvnew_test= na.omit(dfvnew_test)
```










# Multinomial on final test set
```{r}
start.time <- Sys.time()


# Fit the model
model <- nnet::multinom(pitch_name ~., data = train_set, maxit=1000)

# Summarize the model
#summary(model)

# Make predictions
predicted.classes <- model %>% predict(final_test)
#head(predicted.classes)

# Model accuracy
mean(predicted.classes == final_test$pitch_name)

end.time <- Sys.time()
time.taken <- end.time - start.time
time.taken

vi=varImp(model)

View(vi)
```



## Random Forest on final test set
```{r}
start.time <- Sys.time()


p = ncol(train_set) - 1
rf_fit = randomForest(pitch_name~ ., data = train_set, mtry = round(sqrt(p)), importance = TRUE)


pred =  predict(rf_fit, final_test, type = "class")
tb_rf = table(pred , true = final_test$pitch_name)
confusionMatrix(tb_rf)



end.time <- Sys.time()
time.taken <- end.time - start.time
time.taken

varImpPlot(rf_fit)
```



# Weighted KNN on final test set
```{r}
start.time <- Sys.time()


classifier_knn <- kknn(pitch_name~., train_set, final_test, kernel = "optimal")
  
#summary(classifier_knn)
fit <- fitted(classifier_knn)



cm <- table(fit, final_test$pitch_name) 
confusionMatrix(cm)


end.time <- Sys.time()
time.taken <- end.time - start.time
time.taken
```



# KNN on final test set
```{r}


start.time <- Sys.time()

classifier_knn <- knn(train = train_set, 
    test = final_test, 
    cl = train_set$pitch_name, 
    k=1)


cm <- table(classifier_knn, final_test$pitch_name)
confusionMatrix(cm)

end.time <- Sys.time()
time.taken <- end.time - start.time
time.taken


```












# KNN cross validation results
```{r}

#41 pitchers who had a k!=1 selected when doing cross validation
#KNN: k=3, .7035 k=1, .7019 
#.7035-.7019
#KNN: k=4, .5265 k=1, .5265
#.5265-.5265
#KNN: k=7, .4818 k=1, .4853
#.4818 -.4853
#KNN: k=3, .7483 k=1, .777
#.7483 - .777
#KNN: k=3, .7013 k=1, .7078 
#.7013 -.7078
#KNN: k=2, .9774  k=1, .9472
#.9774  -.9472
#KNN: k=4, .6187 k=1, .6187
#.6187-.6187
#KNN: k=2, .6292, k=1, .6337
#.6292 - .6337
#KNN: k=3, .9157 k=1, .9112
#.9157 -.9112
#KNN: k=3, .5035 k=1, .5 
#.5035- .5
#KNN: K=4 .7288 k=1, .7356
#.7288 -.7356
#KNN: k=3, .5554 k=1, .5574
#.5554 - .5574
#KNN: k=4, .5503, k=1, .5365 
#.5503 -.5365
#KNN: k=9, .8387 k=1, .871
#.8387 -.871
#KNN: k=3, .4735 k=1, .4841
#.4735 -.4841
#KNN: k=2, .6891 k=1, .6567
#.6891 - .6567
#KNN: k=3, .4726 k=1, .4831
#.4726 - .4831
#KNN: k=3, .5276 k=1, .5345
#.5276- .5345
#KNN: k=3, .6221 k=1, .6254
#.6221 - .6254
#KNN: k=2, .7101 k=1, .7074 
#.7101 - .7074
#KNN: k=2, .6607 k=1, .6667
#.6607 - .6667
#KNN: k=6, .6864 k=1, .6721
#.6864 - .6721
#KNN: k=10, .6305 k=1, .6425 
#.6305 - .6425
#KNN: k=3, .6215 k=1, .6215
#.6215 - .6215
#KNN: k=3, .655 k=1, .6612
#.655 - .6612
#KNN: k=3, .567 k=1, .567
#.567 - .567
#KNN: k=9, .8014 k=1, .7874
#.8014 - .7874
#KNN: k=2, .6 k=1, .6079 
#.6 - .6079
#KNN: k=4, .5675 k=1, .5752
#.5675 - .5752
#KNN: k=6, .7392 k=1, .7515
#.7392 - .7515
#KNN: k=10, .6089 k=1, .6044
#.6089- .6044
#KNN: k=2, .5503 k=1, .5484
#.5503 - .5484
#KNN: k=10, .6485 k=1, .6639 
#.6485 - .6639
#KNN: k=2, .4046  k=1, .4046 
#.4046  - .4046
#KNN: k=2, .5133 k=1, .4867
#.5133 - .4867
#KNN: k=3, .5773 k=1, .5773
#.5773 - .5773
#KNN: k=2, .5615 k=1, .5606
#.5615 - .5606
#KNN: k=3, .7123 k=1, .714
#.7123 -.714
#KNN: k=45, .3269 k=1, .3365
#.3269 - .3365
#KNN: k=4, .5166  k=1, .512
#.5166  - .512
#KNN: k=4, .5757 k=1, .5827
#.5757 - .5827



#Subtracting the accuracy obtained using the k value found by cross validation with k=1 accuracy


diff= c(.7035-.7019, .5265-.5265, .4818-.4853, .7483-.777, .7013-.7078, 
        .9774-.9472, .6187-.6187, .6292-.6337, .9157-.9112, .5035-.5,
        .7288-.7356, .5554-.5574, .5503-.5365, .8387-.871, .4735-.4841,
        .6891-.6567, .4726-.4831, .5276-.5345, .6221-.6254, .7101-.7074,
        .6607-.6667, .6864-.6721, .6305-.6425, .6215-.6215, .655-.6612,
        .5670-.5670, .8014-.7874, .6000-.6079, .5675-.5752, .7392-.7515,
        .6089-.6044, .5503-.5484, .6485-.6639, .4046-.4046, .5133-.4867,
        .5773-.5773, .5615-.5606, .7123-.7140, .3269-.3365, .5166-.512,
        .5757-.5827)


mean(diff)

# The mean difference is -0.001119512 which means the value of the default k=1 actually outperforms the cross validation overall by a miniscule amount. 

```


# KNN Results
```{r}

correct= c(.5163, .5901, .6037, .6356, .8245, .6157, .7019, .5265, .6055, .5310, 
           .5795, .4799, .4853, .8222, .7754, .8000, .6699, .5904, .9394, .5714, 
           .7770, .9349, .7594, .5852, .7078, .6177, .7131, .5684, .9472, .5085, 
           .6925, .5995, .4809, .7460, .5578, .6187, .8050, .5997, .6907, .5379, 
           .6337, .8760, .7574, .7808, .6800, .9112, .8227, .4155, .8292, .5000,
           .7276, .7178, .6101, .5517, .7356, .5633, .5574, .5365, .8710, .4841,
           .7947, .5625, .8459, .6567, .8474, .4831, .6646, .5345, .5914, .5425,
           .6254, .7074, .4672, .4661, .5830, .6667, .8450, .6721, .7778, .6425,
           .5798, .6215, .6612, .5670, .7874, .6079, .5752, .6234, .4577, .6184,
           .5251, .7515, .6044, .8232, .6862, .8734, .7500, .5429, .4536, .5426,
           .8443, .6909, .5484, .7785, .7864, .6639, .4046, .9091, .3354, .8548,
           .4867, .8066, .5773, .5672, .5606, .8032, .6011, .5932, .5502, .5278,
           .6749, .7378, .5247, .4675, .6324, .5662, .7140, .7995, .3903, .3365,
           .6244, .4671, .5607, .8567, .5120, .5827)
length(correct)
hist(correct, breaks = 10)
abline(v = mean(correct), col='red', lwd = 3)




runtime= c(.4709, .3685, 1.0264, .6870, .5742, .3026, .4939, .6287, .5406, .5870,
           .3728, .9866, .3485, .1822, .1113, .1307, .1273, .2786, .1217, .1349,
           .0959, .2137, .1778, .2094, .1659, .1556, .1071, .1786, .0962, .1483,
           .1331, .2447, .3610, .5028, .3316, .5147, .4753, .2099, .2699, .2497,
           .1342, .1082, .2024, .1534, .2245, .2956, .0802, .2003, .1900, .1318,
           .1231, .7069, .9536, .2802, .5856, .0881, .3599, .2690, .0963, .1795,
           .1471, .1342, .1125, .1246, .4882, .3780, .4545, .2435, .3338, .3619,
           .3400, .1080, .3379, .4190, 1.4783, .1143, .2501, .1867, .1241, .4948,
           .5261, .1657, .6400, 1.2671, .3943, .3655, .7731, .6776, .2884, .1631,
           .1403, .1506, .1800, .4051, 1.1009, .1222, .2004, .1534, .1547, .5228,
           .1263, .1401, .1510, .5723, .2590, .2136, .1513, .0859, .2501, .1179,
           .1253, .1198, .5037, .2845, .2540, .1283, .3475, .3017, .0973, .1312,
           .6483, .2300, .3372, .2064, .2972, .1657, .1725, .2087, .2734, .1527,
           .3390, .1658, .1513, .1799, .2438, .2040)

mean(runtime)














#Relievers vs. Starters

#Starters
mean(c(.5163, .5901, .6037, .6356, .8245, .6157, .7019, .5265, .6055, .5310,
       .5795, .4799, .5995, .4809, .7460, .5578, .6187, .8050, .5997, .7178, 
       .6101, .7356, .5633, .8474, .4831, .6646, .5425, .6254, .7074, .4661,
       .7778, .6425, .5798, .6612, .5670, .7874, .6079, .5752, .6234, .4577,
       .6862, .5426, .7785, .6639, .5773, .5672, .5606, .6011, .5932, .6749,
       .7378, .5247, .4675, .6324, .7140, .6244, .5120))

#Starters that turn to reliever
c(.5517, .4672, .5429, .7995, .3365)

#Starter to hybrid starter
c(.7500)

#Starter into a hybrid reliever
c(.5574, .6184)

#Hybrid starter to more hybrid reliever
c(.5625, .5914)

#Hybrid starter turned full starter
c(.4853, .3903)

#Relievers
mean(c(.8222, .7754, .8000, .6699, .5904, .9394, .5714, .7770, .9349, .7594,
       .5852, .7078, .6177, .7131, .5684, .9472, .5085, .6925, .6907, .5379,
       .6337, .8760, .7574, .7808, .6800, .9112, .8227, .4155, .8292, .5000,
       .7276, .5365, .8710, .4841, .7947, .8459, .6567, .5830, .6667, .6721,
       .6215, .5251, .7515, .6044, .8734, .4536, .8443, .6909, .5484, .7864,
       .4046, .9091, .8548, .4867, .8066, .8032, .5502, .5278, .5662, .5607))

# Relievers that turn to starter
c(.8450, .3354)

# Hybrid relievers that turn to starter
c(.5345, .8232, .5827)

#Hybrid reliever to hybrid starter
c(.4671)

#Hybrid reliever to full reliever
c(.8567)




#Pitchers who transitioned roles from the 2021 to 2022 season
mean(c(.5517, .4672, .5429, .7995, .3365, .7500, .5574, .6184, .5625, .5914, 
       .4853, .3903, .8450, .3354, .5345, .8232, .5827, .4671, .8567))








# By the pitch that is the naive guess


# Pitchers who throw fastball most often in final test set
mean(c(.5163, .5901, .8245, .6157, .7019, .5265, .5310, .5795, .7754, .8000,
  .6699, .5904, .5714, .7770, .5852, .7131, .9472, .5085, .6925, .5995,
  .4809, .7460, .6187, .8050, .5997, .6907, .8760, .7574, .6800, .9112,
  .8227, .8292, .7276, .7178, .5517, .5574, .8459, .6567, .8474, .4831,
  .6646, .5345, .5914, .7074, .5830, .6667, .8450, .7778, .6215, .6612,
  .7874, .5752, .6184, .7515, .8232, .7500, .5426, .8443, .5484, .7785,
  .7864, .9091, .3354, .8548, .8066, .5773, .5672, .5606, .8032, .6011,
  .5502, .6749, .7378, .4675, .6324, .7140, .6244, .8567, .5120))

# Pitchers who throw changeup most often in final test set
c(.6055)

# Pitchers who throw curevball most often in final test set
mean(c(.5633, .6079, .6234, .5662, .3903))

# Pitchers who throw cutter most often in final test set
mean(c(.9349, .6337, .7808, .7356, .5365, .5670, .4577))

# Pitchers who throw sinker most often in final test set
mean(c(.6356, .4799, .4853, .7078, .6177, .5684, .5578, .5379, .5035, .6101, 
  .8710, .4841, .5625, .5425, .6254, .4672, .4661, .6721, .6425, .5798,
  .4536, .6909, .6639, .4046, .5278, .5247, .3365, .4671, .5607, .5827))

# Pitchers who throw slider most often in final test set
mean(c(.6037, .8222, .9394, .4155, .7947, .5251, .6044, .6862, .5429, .4867,
  .5932))

# Pitchers who throw splitter most often in final test set
c(.7594)

# Pitchers who throw sweeper most often in final test set
mean(c(.8734, .7995))





















#OVERALL TREND THAT AS THE PITCHER HAS MORE PITCHES THE LOWER THE ACCURACY. THIS MAKES SENSE BECASUE THE MORE OPTIONS TO CHOOSE FROM THE HARDER IT IS TO CHOOSE CORRECTLY. 


#Pitchers with 2 pitches
mean(c(.777, .9349, .9472, .8227))

#Pitchers with 3 pitches
mean(c(.7754, .8000, .6699, .9394, .6177, .7131, .6925, .6337, .8760, .7808,
       .9112, .7276, .8710, .8459, .6567, .6667, .7778, .7515, .8734, .8443, 
       .5484, .7864, .6639, .9091, .8548, .8066, .5606, .8032, .5502))

#Pitchers with 4 pitches
mean(c(.5163, .8245, .7019, .5795, .8222, .5714, .7594, .7078, .5684, .5085,
       .5995, .8050, .6907, .7574, .4155, .8292, .5000, .5633, .4841, .7947,
       .5625, .8474, .5345, .6254, .7074, .8450, .6721, .6425, .6215, .7874,
       .6079, .6184, .5251, .6044, .8232, .7500, .5429, .4536, .6909, .4046, 
       .4867, .5672, .5278, .7378, .6324, .7140, .7995, .3365, .5607, .8567))

#Pitchers with 5 pitches
mean(c(.5901, .6356, .6157, .5265, .6055, .5310, .4853, .5904, .5852, .4809,
       .7460, .5578, .6187, .5997, .5379, .6800, .7178, .5517, .5574, .5365,
       .4831, .6646, .5914, .5425, .4672, .4661, .5798, .6612, .6234, .4577, 
       .6862, .5426, .7785, .3354, .5773, .6011, .5932, .6749, .5247, .4675, 
       .5662, .3903, .6244, .4671, .5120, .5827))

#Pitchers with 6 pitches
mean(c(.6101, .7356, .5670, .5752))

#Pitchers with 7 pitches
mean(c(.6037, .4799, .5830))













#Full Data compared to naive guess
mean(c(.5163-.3474, .5901-.3391, .6037-.2872, .6356-.2803, .8245-.4843,
       .6157-.3884, .7019-.4964, .5265-.3302, .6055-.2847, .5310-.4025,
       .5795-.3292, .4799-.3857, .4853-.4196, .8222-.4464, .7754-.5911,
       .8000-.5575, .6699-.4609, .5904-.4481, .9394-.4958, .5714-.4387,
       .7770-.6385, .9349-.7739, .7594-.3726, .5852-.4796, .7078-.3982,
       .6177-.5573, .7131-.4116, .5684-.3705, .9472-.7962, .5085-.3262,
       .6925-.5167, .5995-.2664, .4809-.3982, .7460-.5238, .5578-.4723,
       .6187-.3478, .8050-.5668, .5997-.4183, .6907-.4943, .5379-.3985,
       .8760-.4663, .7574-.5803, .7808-.5684, .6800-.5914, .9112-.8451,
       .8227-.7134, .4155-.3787, .8292-.4791, .5000-.3767, .7276-.5626,
       .7178-.4576, .6101-.4540, .7356-.4169, .5633-.3607, .5574-.4893,
       .8710-.4516, .4841-.3356, .7947-.5918, .5625-.4250, .8459-.5268,
       .6567-.5447, .8474-.5982, .4831-.3267, .6646-.3026, .5345-.3687,
       .5914-.5408, .5425-.4599, .6254-.5008, .7074-.5505, .4661-.3004,
       .5830-.2993, .6667-.4319, .8450-.6117, .6721-.3503, .7778-.5185,
       .6425-.5418, .5798-.4363, .6215-.4906, .6612-.4712, .5670-.5381,
       .7874-.5747, .6079-.2986, .5752-.2621, .6234-.3970, .4577-.3383,
       .6184-.5000, .5251-.3391, .7515-.4414, .6044-.5333, .8232-.5918,
       .6862-.3569, .8734-.5097, .7500-.4343, .5429-.4870, .4536-.4370,
       .5426-.3120, .8443-.6530, .6909-.5134, .5484-.4819, .7785-.4809,
       .7864-.5454, .6639-.4257, .9091-.4848, .8548-.6393, .8066-.5020,
       .5773-.4432, .5672-.3745, .5606-.4923, .8032-.5175, .6011-.4234,
       .5932-.3287, .5502-.4210, .5278-.4876, .6749-.4493, .7378-.4634,
       .5247-.2652, .4675-.3384, .6324-.3385, .5662-.3299, .7140-.4298,
       .7995-.5580, .3903-.3020, .3365-.3076, .6244-.5158, .4671-.3583,
       .5607-.3567, .8567-.6208, .5120-.3051, .5827-.3565, .6337-.6764, 
       .5517-.5931, .5365-.6272, .4672-.5218, .4046-.4122, .3354-.4410,
       .4867-.5066))



# The pitchers who beat the naive guess and by how much

mean(c(.5163-.3474, .5901-.3391, .6037-.2872, .6356-.2803, .8245-.4843,
       .6157-.3884, .7019-.4964, .5265-.3302, .6055-.2847, .5310-.4025,
       .5795-.3292, .4799-.3857, .4853-.4196, .8222-.4464, .7754-.5911,
       .8000-.5575, .6699-.4609, .5904-.4481, .9394-.4958, .5714-.4387,
       .7770-.6385, .9349-.7739, .7594-.3726, .5852-.4796, .7078-.3982,
       .6177-.5573, .7131-.4116, .5684-.3705, .9472-.7962, .5085-.3262,
       .6925-.5167, .5995-.2664, .4809-.3982, .7460-.5238, .5578-.4723,
       .6187-.3478, .8050-.5668, .5997-.4183, .6907-.4943, .5379-.3985,
       .8760-.4663, .7574-.5803, .7808-.5684, .6800-.5914, .9112-.8451,
       .8227-.7134, .4155-.3787, .8292-.4791, .5000-.3767, .7276-.5626,
       .7178-.4576, .6101-.4540, .7356-.4169, .5633-.3607, .5574-.4893,
       .8710-.4516, .4841-.3356, .7947-.5918, .5625-.4250, .8459-.5268,
       .6567-.5447, .8474-.5982, .4831-.3267, .6646-.3026, .5345-.3687,
       .5914-.5408, .5425-.4599, .6254-.5008, .7074-.5505, .4661-.3004,
       .5830-.2993, .6667-.4319, .8450-.6117, .6721-.3503, .7778-.5185,
       .6425-.5418, .5798-.4363, .6215-.4906, .6612-.4712, .5670-.5381,
       .7874-.5747, .6079-.2986, .5752-.2621, .6234-.3970, .4577-.3383,
       .6184-.5000, .5251-.3391, .7515-.4414, .6044-.5333, .8232-.5918,
       .6862-.3569, .8734-.5097, .7500-.4343, .5429-.4870, .4536-.4370,
       .5426-.3120, .8443-.6530, .6909-.5134, .5484-.4819, .7785-.4809,
       .7864-.5454, .6639-.4257, .9091-.4848, .8548-.6393, .8066-.5020,
       .5773-.4432, .5672-.3745, .5606-.4923, .8032-.5175, .6011-.4234,
       .5932-.3287, .5502-.4210, .5278-.4876, .6749-.4493, .7378-.4634,
       .5247-.2652, .4675-.3384, .6324-.3385, .5662-.3299, .7140-.4298,
       .7995-.5580, .3903-.3020, .3365-.3076, .6244-.5158, .4671-.3583,
       .5607-.3567, .8567-.6208, .5120-.3051, .5827-.3565))


# Pitchers who underperformed the naive guess


mean(c(.6337-.6764, .5517-.5931, .5365-.6272, .4672-.5218, .4046-.4122,
  .3354-.4410, .4867-.5066))



# Kenley Jansen (reliver) 
#How much did naive guess outperform
.6337-0.6764

#Not much change in pitch mix %

#What pitch do they throw most often/in general






# Luke Weaver(starter in 2021 and reliever in 2022)
#How much did naive guess outperform
.5517-.5931

#Not much change in pitch mix %

#What pitch do they throw most often/in general





# Michael Fulmer(reliever)
#How much did naive guess outperform
.5365-.6272

#slight variation in pitch mix %. Threw cutter way more in 2022. Sinker and chanegup % were cut in half respectively 

#What pitch do they throw most often/in general






# Jorge Lopez(reliever)
#How much did naive guess outperform
.4672-.5218

#Big increase in sinker % and got rid of four seam

#What pitch do they throw most often/in general





# Brusdar Graterol(reliever )
#How much did naive guess outperform
.4046-.4122

#Predominantly just sinker and slider in 2021. In 2022 more a a true 4 pitch mix

#What pitch do they throw most often/in general






# Bailey Falter(starter)
#How much did naive guess outperform
.3354-.4410

#Big changes in pitch mix %. Pretty similar from 2021 to pre 2022 all star break. But then post all star break abandoned the slider in favor a a curveball and fastball became dominant pitch after sinker had been previously

#What pitch do they throw most often/in general







# Nick Sandlin(reliver)
#How much did naive guess outperform
.4867-.5066

#not much change. Threw slider and splitter a little more frequently while throwing a sinker less frequently

#What pitch do they throw most often/in general

```






# Multinomial Results
```{r}

correct= c(.3514, .2927, .2534, .3336, .3369, .3654, .3626, .2417, .1465, .2658, 
           .3553, .1203, .1817, .4000, .5182, .4825, .4238, .2939, .4049, .4448,
           .6452, .4252, .4787, .2703, .3268, .1830, .5800, .2000, .7358, .3580,
           .4853, .2984, .3887, .2837, .2311, .1889, .2300, .4019, .3950, .0244,
           .4314, .4716, .2000, .5525, .4000, .3325, .5649, .2738, .1645, .3732,
           .4115, .3694, .0863, .1310, .2576, .3122, .1936, .1676, .5806, .3003,
           .5465, .3625, .4050, .5149, .3602, .3045, .3062, .3436, .3949, .2451,
           .1954, .2991, .2794, .0360, .4181, .0766, .4562, .3481, .3727,
           .3212, .3457, .3025, .2123, .3014, .3744, .2374, .3316, .2828, .3092,
           .4020, .4887, .4111, .3911, .2398, .2597, .2021, .3033, .3178, .2418,
           .1775, .0967, .5370, .2341, .4522, .4257, .5343, .3939, .2332, .4660,
           .3400, .2098, .2614, .3234, .3800, .5336, .2868, .2883, .4832, .3827,
           .1342, .1341, .2858, .2426, .2961, .3177, .4072, .2596, .2647, .3653,
           .2024, .3338, .3592, .3283, .0765, .2922)
length(correct)
hist(correct, breaks = 10)
abline(v = mean(correct), col='red', lwd = 3)


runtime= c(2.6074, 3.1341, 24.2350, 7.7226, 3.7204, 2.5443, 2.6510, 6.5963, 5.2138, 
           6.4500, 2.0196, 25.4495, 4.8526, 1.2645, .2126, .4613, .3056, 4.1970, .3825, 
           .6229, .1104, .1194, 1.1739, 2.2203, .9684, .4052, .2345, .7200, .1242, 
           .6415, .3726, .9726, 3.2725, 7.7811, 6.3490, 7.0904, 2.7392, 1.8339, 2.1689, 
           3.0887, .3440, .2451, 1.1665, .4382, 2.2950, .4416, .1053, 1.055, 1.4303, 
           .7845, .3266, 8.0331, 16.6126, 3.7261, 16.0021, .1500, 5.6988, 2.7543, .2874, 
           1.6202, .7121, 1.0960, .2864, .2489, 2.8086, 3.6033, 4.8891, 1.1630, 4.0810, 
           3.7736, 1.6434, 4.5351, 3.3636, 35.6527, .2417, 1.8786, 1.0820, .5586,
           3.5103, 7.7932, 1.2973, 8.5115, 20.7183, 3.7899, 1.9978, 10.5168, 6.5070, 
           2.1812, 1.3288, .7028, .5634, 1.2080, 2.6559, 13.4081, .2879, 1.3032, .7757, 
           .4951, 5.6074, .3062, .7018, .3937, 6.5286, .2193, .6461, .7174, .2088, 
           1.8540, .3165, .6697, .3923, 4.9735, 1.9077, .6978, .3449, 3.0568, 2.5520, 
           .2024, .6101, 6.8939, 1.7837, 2.4901, 1.0281, 1.3641, 1.3313, .9349, 1.3887, 
           2.0812, 1.1192, 3.7650, 1.0377, .7977, 1.1999, 1.9421, 1.1611)
length(runtime)
mean(runtime)












#Relievers vs. Starters

#Starters
mean(c(.3513, .2927, .2534, .3336, .3369, .3654, .3626, .2417, .1465, .2658,
  .3553, .1203, .2984, .3887, .2837, .2311, .1889, .2301, .4019, .3694,
  .0863, .2576, .3122, .3602, .3045, .3062, .2451, .1954, .2794,
  .3481, .3727, .3212, .3025, .2123, .3014, .3744, .2374, .3316, .2828,
  .2398, .2418, .2341, .4257, .2614, .3234, .3801, .2868, .2883, .1342,
  .1341, .2858, .2426, .2961, .4072, .2024, .0765))

#Starters that turn to reliever
c(.1310, .2991, .3033, .2596, .3653)

#Starter to hybrid starter
c(.2021)

#Starter into a hybrid reliever
c(.1936, .3092)

#Hybrid starter to more hybrid reliever
c(.3625, .3949)

#Hybrid starter turned full starter
c(.1817, .2647)

#Relievers
mean(c(.4000, .5182, .4825, .4238, .2939, .4049, .4448, .6452, .4252, .4787,
  .2703, .3268, .1830, .5800, .2000, .7358, .3580, .4853, .3950, .0244,
  .4314, .4716, .2000, .5525, .4000, .3325, .5649, .2738, .1645, .3732,
  .4115, .1676, .5806, .3003, .5465, .4050, .5149, .0360, .4181, .4562,
  .3457, .4020, .4887, .4111, .2597, .3178, .1775, .0967, .5370, .4522,
  .5343, .3939, .4660, .3400, .2098, .5336, .4832, .3827, .3177, .3592))

# Relievers that turn to starter
c(.0766, .2332)

# Hybrid relievers that turn to starter
c(.3436, .3911, .2922)

#Hybrid reliever to hybrid starter
c(.3338)

#Hybrid reliever to full reliever
c(.3283)


#Pitchers who were changing roles
mean(c(.1310, .2991, .3033, .2596, .3653, .2021, .1936, .3092, .3625, .3949, 
       .1817, .2647, .0766, .2332, .3436, .3911, .2922, .3338, .3283))










# Pitchers who throw fastball most often in final test set
mean(c(.3513, .2927, .3369, .3654, .3626, .2417, .2658, .3553, .5182, .4825,
  .4238, .2939, .4448, .6452, .2703, .5800, .7358, .3580, .4853, .2984,
  .3887, .2837, .1889, .2301, .4019, .3950, .4716, .2000, .4000, .3325,
  .5649, .1645, .4115, .3694, .1310, .1936, .4050, .5149, .3602, .3045,
  .3062, .3436, .3949, .0360, .4181, .0766, .3481, .3457, .3025,
  .3014, .2374, .3092, .4887, .3911, .2021, .2418, .1775, .5370, .2341,
  .4522, .3939, .2332, .4660, .2098, .2614, .3234, .3801, .5336, .2868,
  .4832, .1342, .1341, .2426, .2961, .4072, .2024, .3283, .0765))

# Pitchers who throw changeup most often in final test set
c(.1465)

# Pitchers who throw curevball most often in final test set
mean(c(.3122, .3744, .3316, .3177, .2647))

# Pitchers who throw cutter most often in final test set
mean(c(.4252, .4314, .5525, .2576, .1676, .2123, .2828))

# Pitchers who throw sinker most often in final test set
mean(c(.3336, .1203, .1817, .3268, .1830, .2000, .2311, .0244, .3732, .0863,
  .5806, .3003, .3625, .2451, .1954, .2991, .2794, .4562, .3727, .3212,
  .3178, .0967, .4257, .5343, .3827, .2858, .3653, .3338, .3592, .2922))

# Pitchers who throw slider most often in final test set
mean(c(.2534, .4000, .4049, .2738, .5465, .4020, .4111, .2398, .3033, .3400,
  .2883))

# Pitchers who throw splitter most often in final test set
c(.4787)

# Pitchers who throw sweeper most often in final test set
c(.2597, .2596)




















#Pitchers with 2 pitches
mean(c(.6452, .4252, .7358, .5649))

#Pitchers with 3 pitches
mean(c(.5182, .4825, .4238, .4049, .1830, .5800, .4853, .4314, .4716, .5525,
       .3325, .4115, .5806, .4050, .5149, .4181, .3481, .4887, .2597, .1775,
       .5370, .4522, .4257, .3939, .4660, .2098, .3801, .5336, .4832))

#Pitchers with 4 pitches
mean(c(.3513, .3369, .3626, .3553, .4000, .4448, .4787, .3268, .2000, .3580,
       .2984, .2301, .3950, .2000, .2738, .1645, .3732, .3122, .3003, .5465,
       .3625, .3602, .3436, .1954, .0766, .4562, .3727, .3457, .3014,
       .3744, .3092, .4020, .4111, .3911, .2021, .3033, .3178, .0967, .5343,
       .3400, .3234, .3827, .1341, .2961, .4072, .2596, .3653, .2024, .3592,
       .3283))

#Pitchers with 5 pitches
mean(c(.2927, .3336, .3654, .2417, .1465, .2658, .1817, .2939, .2703, .3887,
       .2837, .2311, .1889, .4019, .0244, .4000, .3694, .1310, .1936, .1676,
       .3045, .3062, .3949, .2451, .2991, .2794, .3212, .3025, .3316, .2828,
       .2398, .2418, .2341, .2332, .2614, .2868, .2883, .1342, .2858, .2426,
       .3177, .2647, .3338, .0765, .2922))

#Pitchers with 6 pitches
mean(c(.0863, .2576, .2123, .2374))

#Pitchers with 7 pitches
mean(c(.2534, .1203, .0360))











#Full Data compared to naive guess
mean(c(.3513-.3474, .3336-.2803, .3553-.3292, .4448-.4387, .6452-.6385,
       .4787-.3726, .5800-.4116, .3580-.3262, .2984-.2664, .4716-.4663,
       .5806-.4516, .3062-.3026, .4562-.3503, .3744-.2986, .4020-.3391,
       .4887-.4414, .5370-.4819, .4257-.4257, .5343-.4122, .5336-.5175,
       .4832-.4210, .2858-.2652, .3653-.3076, .3592-.3567, .2927-.3391,
       .2534-.2872, .3369-.4843, .3654-.3884, .3626-.4964, .2417-.3302,
       .1465-.2847, .2658-.4025, .1203-.3857, .1817-.4196, .4000-.4464,
       .5182-.5911, .4825-.5575, .4238-.4609, .2939-.4481, .4049-.4958,
       .4252-.7739, .2703-.4796, .3268-.3982, .1830-.5573, .2000-.3705,
       .7358-.7962, .4853-.5167, .3887-.3982, .2837-.5238, .2311-.4723,
       .1889-.3478, .2301-.5668, .4019-.4183, .3950-.4943, .0244-.3985,
       .4314-.6764, .2000-.5803, .5525-.5684, .4000-.5914, .3325-.8451,
       .5649-.7134, .2738-.3787, .1645-.4791, .3732-.3767, .4115-.5626, 
       .3694-.4576, .0863-.4540, .1310-.5931, .2576-.4169, .3122-.3607, 
       .1936-.4893, .1676-.6272, .3003-.3356, .5465-.5918, .3625-.4250,
       .4050-.5268, .5149-.5447, .3602-.5982, .3045-.3267, .3436-.3687, 
       .3949-.5408, .2451-.4599, .1954-.5008, .2991-.5218, .2794-.3004,
       .0360-.2993, .4181-.4319, .0766-.6117, .3481-.5185, .3727-.5418,
       .3212-.4363, .3457-.4906, .3025-.4712, .2123-.5381, .3014-.5747, 
       .2374-.2621, .3316-.3970, .2828-.3383, .3092-.5000, .4111-.5333, 
       .3911-.5918, .2398-.3569, .2597-.5097, .2021-.4343, .3033-.4870, 
       .3178-.4370, .2418-.3120, .1775-.6530, .0967-.5134, .2341-.4809, 
       .4522-.5454, .3939-.4848, .2332-.4410, .4660-.6393, .3400-.5066, 
       .2098-.5020, .2614-.4432, .3234-.3745, .3801-.4923, .2868-.4234, 
       .2883-.3287, .3827-.4876, .1342-.4493, .1341-.4634, .2426-.3384, 
       .2961-.3385, .3177-.3299, .4072-.4298, .2596-.5580, .2647-.3020, 
       .2024-.5158, .3338-.3583, .3283-.6208, .0765-.3051, .2922-.3565))

# The pitchers who beat the naive guess and by how much

mean(c(.3513-.3474, .3336-.2803, .3553-.3292, .4448-.4387, .6452-.6385,
       .4787-.3726, .5800-.4116, .3580-.3262, .2984-.2664, .4716-.4663,
       .5806-.4516, .3062-.3026, .4562-.3503, .3744-.2986, .4020-.3391,
       .4887-.4414, .5370-.4819, .4257-.4257, .5343-.4122, .5336-.5175,
       .4832-.4210, .2858-.2652, .3653-.3076, .3592-.3567))

# Pitchers who underperformed the naive guess
mean(c(.2927-.3391, .2534-.2872, .3369-.4843, .3654-.3884, .3626-.4964,
       .2417-.3302, .1465-.2847, .2658-.4025, .1203-.3857, .1817-.4196,
       .4000-.4464, .5182-.5911, .4825-.5575, .4238-.4609, .2939-.4481,
       .4049-.4958, .4252-.7739, .2703-.4796, .3268-.3982, .1830-.5573,
       .2000-.3705, .7358-.7962, .4853-.5167, .3887-.3982, .2837-.5238,
       .2311-.4723, .1889-.3478, .2301-.5668, .4019-.4183, .3950-.4943,
       .0244-.3985, .4314-.6764, .2000-.5803, .5525-.5684, .4000-.5914,
       .3325-.8451, .5649-.7134, .2738-.3787, .1645-.4791, .3732-.3767,
       .4115-.5626, .3694-.4576, .0863-.4540, .1310-.5931, .2576-.4169,
       .3122-.3607, .1936-.4893, .1676-.6272, .3003-.3356, .5465-.5918,
       .3625-.4250, .4050-.5268, .5149-.5447, .3602-.5982, .3045-.3267,
       .3436-.3687, .3949-.5408, .2451-.4599, .1954-.5008, .2991-.5218,
       .2794-.3004, .0360-.2993, .4181-.4319, .0766-.6117, .3481-.5185, 
       .3727-.5418, .3212-.4363, .3457-.4906, .3025-.4712, .2123-.5381, 
       .3014-.5747, .2374-.2621, .3316-.3970, .2828-.3383, .3092-.5000,
       .4111-.5333, .3911-.5918, .2398-.3569, .2597-.5097, .2021-.4343,
       .3033-.4870, .3178-.4370, .2418-.3120, .1775-.6530, .0967-.5134,
       .2341-.4809, .4522-.5454, .3939-.4848, .2332-.4410, .4660-.6393,
       .3400-.5066, .2098-.5020, .2614-.4432, .3234-.3745, .3801-.4923,
       .2868-.4234, .2883-.3287, .3827-.4876, .1342-.4493, .1341-.4634,
       .2426-.3384, .2961-.3385, .3177-.3299, .4072-.4298, .2596-.5580,
       .2647-.3020, .2024-.5158, .3338-.3583, .3283-.6208, .0765-.3051,
       .2922-.3565))


```





# Random Forest Results
```{r}

correct= c(.3602, .3582, .3187, .3286, .5094, .3937, .4553, .3067, .3464, 
           .3040, .3612, .3529, .4667, .5413, .5400, .4688, .4313, .4876, .4347,
           .6757, .7280, .3986, .4111, .4654, .5372, .5780, .3347, .7774, .3157,
           .4163, .3304, .2997, .4722, .4121, .3144, .5077, .3105, .4808, .4254,
           .5730, .5202, .6098, .5685, .5800, .7722, .6454, .4005, .4688, .2993,
           .5308, .4921, .4326, .5632, .4441, .4072, .4404, .3590, .3498,
           .4057, .5627, .4950, .5631, .3629, .3039, .3549, .4689, .3119,
           .4397, .4738, .2763, .4150, .4300, .5775, .4379, .5259,
           .4283, .5187, .4150, .4976, .4790, .3956, .2776, .4011, .3543, .4276,
           .3869, .4435, .4956, .5551, .3545, .3669, .4202, .3513, .3013, .3033,
           .5765, .5618, .5123, .4605, .5273, .4174, .5496, .2199, .6206,
           .4067, .5350, .3908, .3317, .4465, .5067, .3616, .3756, .4450, .4815,
           .4292, .4665, .3081, .2689, .3472, .3809, .4419, .4328, .3054, .3173,
           .4389, .3017, .3398, .5970, .3280, .3592)
length(correct)
hist(correct, breaks = 10)
abline(v = mean(correct), col='red', lwd = 3)


runtime= c(39.0688, 27.9914, 88.4305, 62.4954, 49.9568, 26.7387, 48.0196, 63.8498, 
            56.0009, 40.1307, 85.7892, 31.2387, 16.4059, 5.16390, 10.6412,
           9.42544, 28.3135, 11.1361, 10.5138, 1.76716, 1.86709, 16.4603, 16.3006, 
           14.1095, 8.83225, 6.44806, 12.6416, 1.62297, 12.6779, 7.25090, 23.0710, 
           30.6570, 59.8806, 55.7399, 66.1413, 41.0916, 16.7719, 32.3715, 19.2835,
           10.5242, 5.47075, 14.0942, 9.03925, 14.5900, 11.7299, 1.47491, 14.5291, 
           16.0762, 10.4563, 10.1218, 67.8412, 80.9356, 23.9727, 72.8406, 3.64223, 
           43.6084, 22.8353, 15.1876, 9.82382, 7.60948, 6.55563, 
           35.1032, 38.1441, 55.0794, 17.6489, 33.3162, 37.8709, 26.5685, 
           43.1555, 41.2857, 108.253, 6.67196, 16.1154, 14.5857, 36.0783,
           59.5097, 14.4312, 74.6992, 87.4389, 55.8882, 42.3018, 70.4284, 61.2114, 
           21.5601, 11.1818, 10.7747, 11.5156, 11.7535, 28.3752, 80.8426, 8.97563, 
           16.8586, 10.9995, 10.8505, 55.4505, 7.89610, 9.69196, 9.79502, 45.1255, 
           5.20602, 19.5699, 6.62916, 11.5798, 6.02166, 7.95722, 9.03525, 
           44.5505, 27.2221, 21.5986, 6.69656, 23.1417, 23.0383, 4.09290, 7.66958,
           49.9235, 24.8439, 30.4196, 11.0003, 26.1856, 11.0313, 12.6863, 19.8973, 
           22.4302, 19.1470, 29.6906, 8.58514, 8.67659, 13.4959, 16.4918, 9.49100)
length(runtime)
mean(runtime)












#Relievers vs. Starters

#Starters
mean(c(.3602, .3582, .3187, .3286, .5094, .3937, .4553, .3067, .3464,
       .3040, .3612, .3304, .2997, .4722, .4121, .3144, .5077, .3105, .4921,
       .4326, .4441, .4072, .5631, .3629, .3039, .3119, .4397, .2763,
       .5259, .4283, .4150, .4976, .4790, .3956, .2776, .4011, .3543,
       .3545, .3033, .4605, .4174, .3908, .3317, .4465, .3616, .3756, .4292,
       .4665, .3081, .2689, .3472, .4419, .4389, .3280))

#Starters that turn to reliever
c(.5632, .4738, .3513, .4328, .3173)

#Starter to hybrid starter
c(.4202)

#Starter into a hybrid reliever
c(.4404, .4276)

#Hybrid starter to more hybrid reliever
c(.4689)

#Hybrid starter turned full starter
c(.3529, .3054)

#Relievers
mean(c(.4667, .5413, .5400, .4688, .4313, .4876, .4347, .6757, .7280, .3986,
       .4111, .4654, .5372, .5780, .3347, .7774, .3157, .4163, .4808, .4254,
       .5730, .5202, .6098, .5685, .5800, .7722, .6454, .4005, .4688, .2993,
       .5308, .3590, .3498, .4057, .5627, .4950, .4150, .4300, .4379,
       .5187, .3869, .4435, .4956, .3669, .3013, .5765, .5618, .5123, .5273,
       .5496, .6206, .4067, .5350, .5067, .4450, .4815, .3809, .3398))

# Relievers that turn to starter
c(.5775, .2199)

# Hybrid relievers that turn to starter
c(.3549, .5551, .3592)

#Hybrid reliever to hybrid starter
c(.3017)

#Hybrid reliever to full reliever
c(.5970)

#Pitchers who were transitioning roles
mean(c(.5632, .4738, .3513, .4328, .3173, .4202, .4404, .4276, .4689, .3529,
       .3054, .5775, .2199, .3549, .5551, .3592, .3017, .5970))











# Pitchers who throw fastball most often in final test set
mean(c(.3602, .3582, .5094, .3937, .4553, .3067, .3464, .3040, .5413, .5400,
       .4688, .4313, .4347, .6757, .4111, .5780, .7774, .3157, .4163, .3304,
       .2997, .4722, .3144, .5077, .3105, .4808, .5202, .6098, .5800, .7722,
       .6454, .4688, .5308, .4921, .5632, .4404, .5627, .4950, .5631, .3629,
       .3039, .3549, .4689, .4150, .4300, .5775, .5187, .4150,
       .4790, .2776, .4276, .4435, .5551, .4202, .3033, .5765, .5123, .4605,
       .5273, .2199, .6206, .5350, .3908, .3317, .4465, .5067, .3616,
       .4450, .4292, .4665, .2689, .3472, .4419, .4389, .5970, .3280))

# Pitchers who throw changeup most often in final test set
c()

# Pitchers who throw curevball most often in final test set
mean(c(.4072, .3956, .4011, .3809, .3054))

# Pitchers who throw cutter most often in final test set
mean(c(.7280, .5730, .5685, .4441, .3590, .4976, .3543))

# Pitchers who throw sinker most often in final test set
mean(c(.3286, .3612, .3529, .4654, .5372, .3347, .4121, .4254, .2993, .4326,
       .3498, .3119, .4397, .4738, .2763, .4379, .5259, .4283,
       .3013, .5618, .4174, .5496, .4815, .3081, .3173, .3017, .3398, .3592)) 

# Pitchers who throw slider most often in final test set
mean(c(.3187, .4667, .4876, .4005, .4057, .3869, .4956, .3545, .3513, .4067,
       .3756))

# Pitchers who throw splitter most often in final test set
c(.3986)

# Pitchers who throw sweeper most often in final test set
mean(c(.3669, .4328))




















#Pitchers with 2 pitches
mean(c(.6757, .7280, .7774, .6454))

#Pitchers with 3 pitches
mean(c(.5413, .5400, .4688, .4876, .5372, .5780, .4163, .5730, .5202, .5685,
       .7722, .5308, .5627, .4950, .4300, .4435, .3669, .5765,
       .5123, .5273, .4174, .6206, .5350, .4465, .5067, .4450))

#Pitchers with 4 pitches
mean(c(.3602, .5094, .4553, .3040, .4667, .4347, .3986, .4654, .3347, .3157,
       .3304, .5077, .4808, .6098, .4005, .4688, .2993, .4072, .3498, .4057,
       .5631, .3549, .4397, .5775, .4379, .5259, .5187, .4790,
       .3956, .4276, .3869, .4956, .5551, .4202, .3513, .3013, .5618, .5496,
       .4067, .3317, .4815, .4665, .3472, .4419, .4328, .3173, .3398, .5970))

#Pitchers with 5 pitches
mean(c(.3582, .3286, .3937, .3067, .3464, .3529, .4313, .4111, .2997,
       .4722, .4121, .3144, .3105, .4254, .5800, .4921, .5632, .4404, .3590,
       .3629, .3039, .4689, .3119, .4738, .2763, .4283, .4150, .4011, .3543,
       .3545, .3033, .4605, .2199, .3908, .3616, .3756, .4292, .3081, .2689,
       .3809, .3054, .4389, .3017, .3280, .3592))

#Pitchers with 6 pitches
mean(c(.4326, .4441, .4976, .2776))

#Pitchers with 7 pitches
mean(c(.3187, .3612, .4150))









#Full Data compared to naive guess
mean(c(.3602-.3474, .3582-.3391, .3187-.2872, .3286-.2803, .5094-.4843,
       .3937-.3884, .4667-.4464, .4688-.4609, .6757-.6385, .3986-.3726,
       .4654-.3982, .5780-.4116, .3304-.2664, .4254-.3985, .5202-.4663, 
       .6098-.5803, .5685-.5684, .4005-.3787, .4921-.4576, .4441-.4169, 
       .4072-.3607, .3498-.3356, .5627-.5268, .3629-.3267, .3039-.3026,
       .4150-.2993, .4379-.3503, .5187-.4906, .3956-.2986, .2776-.2621,
       .4011-.3970, .3543-.3383, .3869-.3391, .4435-.4414, .5618-.5134, 
       .5123-.4819, .5496-.4122, .5350-.5020, .3756-.3287, .4450-.4210, 
       .4665-.4634, .3081-.2652, .3472-.3385, .3809-.3299, .4419-.4298,
       .3054-.3020, .3173-.3076, .3280-.3051, .3592-.3565, .4553-.4964,
       .3067-.3302, .3464-.4025, .3040-.3292, .3612-.3857, .3529-.4196,
       .5413-.5911, .5400-.5575, .4313-.4481, .4876-.4958, .4347-.4387,
       .7280-.7739, .4111-.4796, .5372-.5573, .3347-.3705, .7774-.7962,
       .3157-.3262, .4163-.5167, .2997-.3982, .4722-.5238, .4121-.4723,
       .3144-.3478, .5077-.5668, .3105-.4183, .4808-.4943, .5730-.6764,
       .5800-.5914, .7722-.8451, .6454-.7134, .4688-.4791, .2993-.3767,
       .5308-.5626, .4326-.4540, .5632-.5931, .4404-.4893, .3590-.6272,
       .4057-.5918, .4950-.5447, .5631-.5982, .3549-.3687, .4689-.5408,
       .3119-.4599, .4397-.5008, .4738-.5218, .2763-.3004, .4300-.4319, 
       .5775-.6117, .5259-.5418, .4283-.4363, .4150-.4712, .4976-.5381,
       .4790-.5747, .4276-.5000, .4956-.5333, .5551-.5918, .3545-.3569, 
       .3669-.5097, .4202-.4343, .3513-.4870, .3013-.4370, .3033-.3120,
       .5765-.6530, .4605-.4809, .5273-.5454, .4174-.4257, .2199-.4410, 
       .6206-.6393, .4067-.5066, .3908-.4432, .3317-.3745, .4465-.4923,
       .5067-.5175, .3616-.4234, .4815-.4876, .4292-.4493, .2689-.3384, 
       .4328-.5580, .4389-.5158, .3017-.3583, .3398-.3567, .5970-.6208))


# The pitchers who beat the naive guess and by how much

mean(c(.3602-.3474, .3582-.3391, .3187-.2872, .3286-.2803, .5094-.4843,
       .3937-.3884, .4667-.4464, .4688-.4609, .6757-.6385, .3986-.3726,
       .4654-.3982, .5780-.4116, .3304-.2664, .4254-.3985, .5202-.4663, 
       .6098-.5803, .5685-.5684, .4005-.3787, .4921-.4576, .4441-.4169, 
       .4072-.3607, .3498-.3356, .5627-.5268, .3629-.3267, .3039-.3026,
       .4150-.2993, .4379-.3503, .5187-.4906, .3956-.2986, .2776-.2621,
       .4011-.3970, .3543-.3383, .3869-.3391, .4435-.4414, .5618-.5134, 
       .5123-.4819, .5496-.4122, .5350-.5020, .3756-.3287, .4450-.4210, 
       .4665-.4634, .3081-.2652, .3472-.3385, .3809-.3299, .4419-.4298,
       .3054-.3020, .3173-.3076, .3280-.3051, .3592-.3565))

# Pitchers who underperformed the naive guess
mean(c(.4553-.4964, .3067-.3302, .3464-.4025, .3040-.3292, .3612-.3857,
       .3529-.4196, .5413-.5911, .5400-.5575, .4313-.4481, .4876-.4958,
       .4347-.4387, .7280-.7739, .4111-.4796, .5372-.5573, .3347-.3705,
       .7774-.7962, .3157-.3262, .4163-.5167, .2997-.3982, .4722-.5238,
       .4121-.4723, .3144-.3478, .5077-.5668, .3105-.4183, .4808-.4943,
       .5730-.6764, .5800-.5914, .7722-.8451, .6454-.7134, .4688-.4791,
       .2993-.3767, .5308-.5626, .4326-.4540, .5632-.5931, .4404-.4893,
       .3590-.6272, .4057-.5918, .4950-.5447, .5631-.5982, .3549-.3687,
       .4689-.5408, .3119-.4599, .4397-.5008, .4738-.5218, .2763-.3004,
       .4300-.4319, .5775-.6117, .5259-.5418, .4283-.4363, .4150-.4712, 
       .4976-.5381, .4790-.5747, .4276-.5000, .4956-.5333, .5551-.5918,
       .3545-.3569, .3669-.5097, .4202-.4343, .3513-.4870, .3013-.4370, 
       .3033-.3120, .5765-.6530, .4605-.4809, .5273-.5454, .4174-.4257, 
       .2199-.4410, .6206-.6393, .4067-.5066, .3908-.4432, .3317-.3745, 
       .4465-.4923, .5067-.5175, .3616-.4234, .4815-.4876, .4292-.4493,
       .2689-.3384, .4328-.5580, .4389-.5158, .3017-.3583, .3398-.3567, 
       .5970-.6208))

```






# Weighted KNN Results
```{r}

correct= c(.3211, .3407, .2412, .3136, .4579, .3257, .3875, .2561, .2688, 
           .2641, .2686, .2872, .4242, .5125, .4675, .3633, .3494, .5069, .3878,
           .5861, .6284, .3208, .3333, .4481, .4990, .4927, .2926, .6906, .3284,
           .3536, .2780, .2647, .4167, .2814, .2843, .4076, .3007, .3837, .3912,
           .4764, .5040, .5148, .5571, .4257, .6241, .5381, .3202, .4438, .2993,
           .4235, .4030, .3597, .4575, .4508, .3945, .3660, .3057, .3004,
           .3914, .4982, .4776, .4808, .3174, .2530, .2919, .3619, .2536,
           .3599, .3777, .3406, .2512, .3476, .3964, .4600, .4134, .4988,
           .3576, .4112, .3900, .4014, .3598, .3295, .2421, .3570, .3036, .4013,
           .3518, .4251, .4733, .4859, .3187, .3766, .3883, .3134, .2815, .2368,
           .4645, .4597, .4649, .3756, .4477, .3669, .4656, .1920, .5340,
           .3367, .4444, .3027, .3175, .4160, .4555, .2978, .2819, .4354, .3827,
           .3142, .4085, .2249, .2519, .3024, .2953, .3847, .3850, .2500, .2212,
           .3473, .2818, .2791, .4925, .2880, .3011)

length(correct)

hist(correct, breaks = 10)
abline(v = mean(correct), col='red', lwd = 3)


runtime= c(.5282, .4227, 1.1262, .7697, .6484, .3087, .5267, .6773, .6985, 
           .4185, 1.0551, .3501, .1858, .1236, .1407, .1250, .2575, .1220, .1842,
           .1008, .0870, .1540, .2124, .1546, .1323, .1205, .1451, .0887, .1571,
           .1209, .4648, .4379, .4063, .2139, .4362, .5223, .1893, .2413, .2182,
           .1346, .1019, .3402, .1364, .1647, .1949, .1152, .2263, .2183, .1254,
           .1417, .7570, 1.4460, .2230, .4128, .1467, .8015, .2156, .1602,
           .1736, .1044, .1242, .4666, .3742, .3434, .3025, .8691, .3686,
           .3738, .1020, .3805, .4221, 1.5672, .1255, .2304, .1675, .5298,
           .4864, .1511, .5726, 1.3762, .9483, .3665, .8232, .6896, .3048, .1124,
           .1340, .1569, .1575, .4375, 1.1547, .1016, .2062, .1526, .1278, .4694,
           .1197, .1182, .1424, .5468, .1279, .1931, .1085, .2393, .1072,
           .1212, .1037, .5073, .2910, .2749, .1198, .3617, .3075, .0945, .1238,
           .5707, .1701, .3742, .2267, .3321, .1495, .1620, .2050, .2796, .1105,
           .3188, .1926, .1555, .2107, .2543, .2674)
length(runtime)
mean(runtime)











#Relievers vs. Starters

#Starters
mean(c(.3211, .3407, .2412, .3136, .4579, .3257, .3875, .2561, .2688,
       .2641, .2686, .2780, .2647, .4167, .2814, .2843, .4076, .3007, .4030,
       .3597, .4508, .3945, .4808, .3174, .2530, .2536, .3599, .3777, .2512,
       .4988, .3576, .3900, .4014, .3598, .3295, .2421, .3570, .3036,
       .3187, .2368, .3756, .3669, .3027, .3175, .4160, .2978, .2819, .3142,
       .4085, .2249, .2519, .3024, .3847, .3473, .2880))

#Starters that turn to reliever
c(.4575, .3406, .3134, .3850, .2212)

#Starter to hybrid starter
c(.3883) 

#Starter into a hybrid reliever
c(.3660, .4013)

#Hybrid starter to more hybrid reliever
c(.3619)

#Hybrid starter turned full starter
c(.2872, .2500)

#Relievers
mean(c(.4242, .5125, .4675, .3633, .3494, .5069, .3878, .5861, .6284, .3208,
       .3333, .4481, .4990, .4927, .2926, .6906, .3284, .3536, .3837, .3912,
       .4764, .5040, .5148, .5571, .4257, .6241, .5381, .3202, .4438, .2993,
       .4235, .3057, .3004, .3914, .4982, .4776, .3476, .3964, .4134,
       .4112, .3518, .4251, .4733, .3766, .2815, .4645, .4597, .4649, .4477,
       .4656, .5340, .3367, .4444, .4555, .4354, .3827, .2953, .2791))

# Relievers that turn to starter
c(.4600, .1920)

# Hybrid relievers that turn to starter
c(.2919, .4859, .3011)

#Hybrid reliever to hybrid starter
c(.2818)

#Hybrid reliever to full reliever
c(.4925)


#Pitchers who were transitioning roles
mean(c(.4575, .3406, .3134, .3850, .2212, .3883, .3660, .4013, .3619, .2872,
       .2500, .4600, .1920, .2919, .4859, .3011, .2818, .4925))











# Pitchers who throw fastball most often in final test set
mean(c(.3211, .3407, .4579, .3257, .3875, .2561, .2688, .2641, .5125, .4675,
  .3633, .3494, .3878, .5861, .3333, .4927, .6906, .3284, .3536, .2780,
  .2647, .4167, .2843, .4076, .3007, .3837, .5040, .5148, .4257, .6241,
  .5381, .4438, .4235, .4030, .4575, .3660, .4982, .4776, .4808, .3174,
  .2530, .2919, .3619, .3777, .3476, .3964, .4600, .4112, .3900,
  .3598, .2421, .4013, .4251, .4859, .3883, .2368, .4645, .4649, .3756,
  .4477, .1920, .5340, .4444, .3027, .3175, .4160, .4555, .2978,
  .4354, .3142, .4085, .2519, .3024, .3847, .3473, .4925, .2880))

# Pitchers who throw changeup most often in final test set
c()

# Pitchers who throw curevball most often in final test set
mean(c(.3945, .3295, .3570, .2953, .2500))

# Pitchers who throw cutter most often in final test set
mean(c(.6284, .4764, .5571, .4508, .3057, .4014, .3036))

# Pitchers who throw sinker most often in final test set
mean(c(.3136, .2686, .2872, .4481, .4990, .2926, .2814, .3912, .2993, .3597,
  .3004, .2536, .3599, .3406, .2512, .4134, .4988, .3576,
  .2815, .4597, .3669, .4656, .3827, .2249, .2212, .2818, .2791, .3011))

# Pitchers who throw slider most often in final test set
mean(c(.2412, .4242, .5069, .3202, .3914, .3518, .4733, .3187, .3134, .3367,
  .2819))

# Pitchers who throw splitter most often in final test set
c(.3208)

# Pitchers who throw sweeper most often in final test set
mean(c(.3766, .3850))




















#Pitchers with 2 pitches
mean(c(.5861, .6284, .6906, .5381))

#Pitchers with 3 pitches
mean(c(.5125, .4675, .3633, .5069, .4990, .4927, .3536, .4764, .5040, .5571,
       .6241, .4235, .4982, .4776, .3964, .4251, .3766, .4645,
       .4649, .4477, .3669, .5340, .4444, .4160, .4555, .4354))

#Pitchers with 4 pitches
mean(c(.3211, .4579, .3875, .2641, .4242, .3878, .3208, .4481, .2926, .3284,
       .2780, .4076, .3837, .5148, .3202, .4438, .2993, .3945, .3004, .3914,
       .4808, .2919, .3599, .3777, .4600, .4134, .4988, .4112, .3598,
       .3295, .4013, .3518, .4733, .4859, .3883, .3134, .2815, .4597, .4656,
       .3367, .3175, .3827, .4085, .3024, .3847, .3850, .2212, .2791, .4925))

#Pitchers with 5 pitches
mean(c(.3407, .3136, .3257, .2561, .2688, .2872, .3494, .3333, .2647,
       .4167, .2814, .2843, .3007, .3912, .4257, .4030, .4575, .3660, .3057,
       .3174, .2530, .3619, .2536, .3406, .2512, .3576, .3900, .3570, .3036,
       .3187, .2368, .3756, .1920, .3027, .2978, .2819, .3142, .2249, .2519,
       .2953, .2500, .3473, .2818, .2880, .3011))

#Pitchers with 6 pitches
mean(c(.3597, .4508, .4014, .2421))

#Pitchers with 7 pitches
mean(c(.2412, .2686, .3476))











#Full Data compared to naive guess
mean(c(.3407-.3391, .3136-.2803, .5069-.4958, .4481-.3982, .4927-.4116,
       .3284-.3262, .2780-.2664, .5040-.4663, .4508-.4169, .3945-.3607,
       .3476-.2993, .4134-.3503, .3295-.2986, .3518-.3391, .4656-.4122,
       .4354-.4210, .3211-.3474, .2412-.2872, .4579-.4843, .3257-.3884, 
       .3875-.4964, .2561-.3302, .2688-.4025, .2641-.3292, .2686-.3857,
       .2872-.4196, .4242-.4464, .5125-.5911, .4675-.5575, .3633-.4609, 
       .3494-.4481, .3878-.4387, .5861-.6385, .6284-.7739, .3208-.3726, 
       .3333-.4796, .4990-.5573, .2926-.3705, .6906-.7962, .3536-.5167, 
       .2647-.3982, .4167-.5238, .2814-.4723, .2843-.3478, .4076-.5668, 
       .3007-.4183, .3837-.4943, .3912-.3985, .4764-.6764, .5148-.5803, 
       .5571-.5684, .4257-.5914, .6241-.8451, .5381-.7134, .3202-.3787, 
       .4438-.4791, .2993-.3767, .4235-.5626, .4030-.4576, .3597-.4540, 
       .4575-.5931, .3660-.4893, .3057-.6272, .3004-.3356, .3914-.5918,
       .4982-.5268, .4776-.5447, .4808-.5982, .3174-.3267, .2530-.3026,
       .2919-.3687, .3619-.5408, .2536-.4599, .3599-.5008, .3777-.5505,
       .3406-.5218, .2512-.3004, .3964-.4319, .4600-.6117, .4988-.5418, 
       .3576-.4363, .4112-.4906, .3900-.4712, .4014-.5381, .3598-.5747, 
       .2421-.2621, .3570-.3970, .3036-.3383, .4013-.5000, .4251-.4414,
       .4733-.5333, .4859-.5918, .3187-.3569, .3766-.5097, .3883-.4343, 
       .3134-.4870, .2815-.4370, .2368-.3120, .4645-.6530, .4597-.5134, 
       .4649-.4819, .3756-.4809, .4477-.5454, .3669-.4257, .1920-.4410,
       .5340-.6393, .3367-.5066, .4444-.5020, .3027-.4432, .3175-.3745, 
       .4160-.4923, .4555-.5175, .2978-.4234, .2819-.3287, .3827-.4876, 
       .3142-.4493, .4085-.4634, .2249-.2652, .2519-.3384, .3024-.3385, 
       .2953-.3299, .3847-.4298, .3850-.5580, .2500-.3020, .2212-.3076, 
       .3473-.5158, .2818-.3583, .2791-.3567, .4925-.6208, .2880-.3051, 
       .3011-.3565))

# The pitchers who beat the naive guess and by how much

mean(c(.3407-.3391, .3136-.2803, .5069-.4958, .4481-.3982, .4927-.4116,
       .3284-.3262, .2780-.2664, .5040-.4663, .4508-.4169, .3945-.3607,
       .3476-.2993, .4134-.3503, .3295-.2986, .3518-.3391, .4656-.4122,
       .4354-.4210))

# Pitchers who underperformed the naive guess
mean(c(.3211-.3474, .2412-.2872, .4579-.4843, .3257-.3884, .3875-.4964,
       .2561-.3302, .2688-.4025, .2641-.3292, .2686-.3857, .2872-.4196,
       .4242-.4464, .5125-.5911, .4675-.5575, .3633-.4609, .3494-.4481,
       .3878-.4387, .5861-.6385, .6284-.7739, .3208-.3726, .3333-.4796,
       .4990-.5573, .2926-.3705, .6906-.7962, .3536-.5167, .2647-.3982, 
       .4167-.5238, .2814-.4723, .2843-.3478, .4076-.5668, .3007-.4183, 
       .3837-.4943, .3912-.3985, .4764-.6764, .5148-.5803, .5571-.5684,
       .4257-.5914, .6241-.8451, .5381-.7134, .3202-.3787, .4438-.4791,
       .2993-.3767, .4235-.5626, .4030-.4576, .3597-.4540, .4575-.5931,
       .3660-.4893, .3057-.6272, .3004-.3356, .3914-.5918, .4982-.5268, 
       .4776-.5447, .4808-.5982, .3174-.3267, .2530-.3026, .2919-.3687, 
       .3619-.5408, .2536-.4599, .3599-.5008, .3777-.5505, .3406-.5218,
       .2512-.3004, .3964-.4319, .4600-.6117, .4988-.5418, .3576-.4363,
       .4112-.4906, .3900-.4712, .4014-.5381, .3598-.5747, .2421-.2621, 
       .3570-.3970, .3036-.3383, .4013-.5000, .4251-.4414, .4733-.5333,
       .4859-.5918, .3187-.3569, .3766-.5097, .3883-.4343, .3134-.4870,
       .2815-.4370, .2368-.3120, .4645-.6530, .4597-.5134, .4649-.4819, 
       .3756-.4809, .4477-.5454, .3669-.4257, .1920-.4410, .5340-.6393,
       .3367-.5066, .4444-.5020, .3027-.4432, .3175-.3745, .4160-.4923,
       .4555-.5175, .2978-.4234, .2819-.3287, .3827-.4876, .3142-.4493,
       .4085-.4634, .2249-.2652, .2519-.3384, .3024-.3385, .2953-.3299,
       .3847-.4298, .3850-.5580, .2500-.3020, .2212-.3076, .3473-.5158,
       .2818-.3583, .2791-.3567, .4925-.6208, .2880-.3051, .3011-.3565))

31/131
```





